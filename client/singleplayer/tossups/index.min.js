import*as e from"https://cdn.jsdelivr.net/npm/qb-answer-checker@1.1.7/dist/main.mjs";var t,s,n,r,a,i={36:(e,t,s)=>{async function n(){const e=await fetch("/api/set-list");return(await e.json()).setList}s.d(t,{A:()=>n})},57:(t,s,n)=>{n.d(s,{A:()=>k});const r=(a={default:()=>e.default},i={},n.d(i,a),i);var a,i,o=n(837);function c(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!(""===t||null==t||!1===t||Array.isArray(t)&&0===t.length||"maxYear"===e&&t===o.d2||"questionType"===e&&"all"===t||"searchType"===e&&"all"===t)))}class l{static checkAnswer(e,t,s=7){return(0,r.default)(e,t,s)}static async getBonusById(e){return await fetch("/api/bonus-by-id?"+new URLSearchParams({id:e})).then(e=>e.json()).then(e=>e.bonus)}static async getNumPackets(e){return void 0===e||""===e?0:await fetch("/api/num-packets?"+new URLSearchParams({setName:e})).then(e=>e.json()).then(e=>e.numPackets)}static async getPacketBonuses(e,t){return""===e?[]:await fetch("/api/packet-bonuses?"+new URLSearchParams({setName:e,packetNumber:t})).then(e=>e.json()).then(e=>e.bonuses)}static async getPacketTossups(e,t){return""===e?[]:await fetch("/api/packet-tossups?"+new URLSearchParams({setName:e,packetNumber:t})).then(e=>e.json()).then(e=>e.tossups)}static async getRandomBonus({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,subcategories:i,threePartBonuses:o}){const l=c({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,subcategories:i,threePartBonuses:o});return await fetch("/api/random-bonus?"+new URLSearchParams(l)).then(e=>e.json()).then(e=>e.bonuses)}static async getRandomTossup({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,powermarkOnly:i,standardOnly:o,subcategories:l}){const u=c({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,powermarkOnly:i,standardOnly:o,subcategories:l});return await fetch("/api/random-tossup?"+new URLSearchParams(u)).then(e=>e.json()).then(e=>e.tossups)}static async getTossupById(e){return await fetch("/api/tossup-by-id?"+new URLSearchParams({id:e})).then(e=>e.json()).then(e=>e.tossup)}}function u(e,t,s={'<span class="text-highlight">':[],"</span>":[]},n){e=e.replace(/…/g,"...");const r=JSON.parse(JSON.stringify(s)),a=[];let i=0,o=0,c=0;const l=function(e,t){if(!t||"string"!=typeof t)return;if(2===!Object.keys(e).length)throw new Error("If openingToken is specified, tokensToIndices must contain exactly two keys: the opening and closing tokens.");if(!Object.keys(e).includes(t))throw new Error(`If openingToken is specified, arrayOfTokens must contain the opening token "${t}".`);return Object.keys(e).find(e=>e!==t)}(r,n);let u=!1;for(;i<=t.length;){if(u&&n)for(;"<"!==t.charAt(i)&&"<"===e.charAt(o)&&"/"===e.charAt(o+1);){for(a.push(e.substring(c,o)),a.push(l),c=o;"<"===e.charAt(o)&&"<"!==t.charAt(i);){for(;">"!==e.charAt(o)&&o<e.length-1;)o++;o++}a.push(e.substring(c,o)),a.push(n),c=o}for(;"<"===e.charAt(o)&&"<"!==t.charAt(i);){for(;">"!==e.charAt(o)&&o<e.length-1;)o++;o++}for(;["·","⋅","‧"].includes(e.charAt(o))&&!["·","⋅","‧"].includes(t.charAt(i))&&o<e.length-1;)o++;"<"===t[i]&&(t=t.slice(0,i)+"〈"+t.slice(i+1),e=e.slice(0,o)+"〈"+e.slice(o+1)),">"===t[i]&&(t=t.slice(0,i)+"〉"+t.slice(i+1),e=e.slice(0,o)+"〉"+e.slice(o+1)),a.push(e.substring(c,o)),c=o;for(const[t,s]of Object.entries(r))s[0]===i&&(a.push(e.substring(c,o)),a.push(t),s.shift(),c=o,u=t===n);i++,o++}return a.push(e.substring(c,e.length)),a.join("").replace(/〈/g,"&lt;").replace(/〉/g,"&gt;")}const d={Literature:["American Literature","British Literature","Classical Literature","European Literature","World Literature","Other Literature"],History:["American History","Ancient History","European History","World History","Other History"],Science:["Biology","Chemistry","Physics","Other Science"],"Fine Arts":["Visual Fine Arts","Auditory Fine Arts","Other Fine Arts"],Religion:["Religion"],Mythology:["Mythology"],Philosophy:["Philosophy"],"Social Science":["Social Science"],"Current Events":["Current Events"],Geography:["Geography"],"Other Academic":["Other Academic"],"Pop Culture":["Movies","Music","Sports","Television","Video Games","Other Pop Culture"]},m=Object.keys(d),g={Literature:["Drama","Long Fiction","Poetry","Short Fiction","Misc Literature"],History:[],Science:["Math","Astronomy","Computer Science","Earth Science","Engineering","Misc Science"],"Fine Arts":["Architecture","Dance","Film","Jazz","Musicals","Opera","Photography","Misc Arts"],Religion:[],Mythology:[],Philosophy:[],"Social Science":["Anthropology","Economics","Linguistics","Psychology","Sociology","Other Social Science"],"Current Events":[],Geography:[],"Other Academic":[],"Pop Culture":[]},h={"American Literature":"Literature","British Literature":"Literature","Classical Literature":"Literature","European Literature":"Literature","World Literature":"Literature","Other Literature":"Literature","American History":"History","Ancient History":"History","European History":"History","World History":"History","Other History":"History",Biology:"Science",Chemistry:"Science",Physics:"Science","Other Science":"Science","Visual Fine Arts":"Fine Arts","Auditory Fine Arts":"Fine Arts","Other Fine Arts":"Fine Arts",Religion:"Religion",Mythology:"Mythology",Philosophy:"Philosophy","Social Science":"Social Science","Current Events":"Current Events",Geography:"Geography","Other Academic":"Other Academic",Movies:"Pop Culture",Music:"Pop Culture",Sports:"Pop Culture",Television:"Pop Culture","Video Games":"Pop Culture","Other Pop Culture":"Pop Culture"},p=Object.keys(h),y={Drama:"Literature","Long Fiction":"Literature",Poetry:"Literature","Short Fiction":"Literature","Misc Literature":"Literature",Math:"Science",Astronomy:"Science","Computer Science":"Science","Earth Science":"Science",Engineering:"Science","Misc Science":"Science",Architecture:"Fine Arts",Dance:"Fine Arts",Film:"Fine Arts",Jazz:"Fine Arts",Musicals:"Fine Arts",Opera:"Fine Arts",Photography:"Fine Arts","Misc Arts":"Fine Arts",Anthropology:"Social Science",Economics:"Social Science",Linguistics:"Social Science",Psychology:"Social Science",Sociology:"Social Science","Other Social Science":"Social Science"},b=Object.keys(y);class w{constructor(e=[],t=[],s=[]){this.import({categories:e,subcategories:t,alternateSubcategories:s})}export(){return{categories:this.categories,subcategories:this.subcategories,alternateSubcategories:this.alternateSubcategories,percentView:this.percentView,categoryPercents:this.categoryPercents}}import({categories:e=[],subcategories:t=[],alternateSubcategories:s=[],percentView:n=!1,categoryPercents:r}={}){if(!r){r=[];for(let e=0;e<m.length;e++)r.push(0)}e.length>0&&0===t.length&&e.forEach(e=>{d[e].forEach(e=>{t.push(e)})}),this.categories=e,this.subcategories=t,this.alternateSubcategories=s,this.percentView=n,this.categoryPercents=r}getRandomCategory(){const e=this.categoryPercents.reduce((e,t)=>e+t,0);if(0===e)return m[Math.floor(Math.random()*m.length)];let t=Math.random()*e;for(let e=0;e<this.categoryPercents.length;e++)if(t-=this.categoryPercents[e],t<=0)return m[e]}isValidCategory(e){if(0===this.categories.length&&0===this.subcategories.length)return!0;const t=["Religion","Mythology","Philosophy","Social Science","Current Events","Geography","Other Academic"].includes(e.subcategory)||this.subcategories.includes(e.subcategory),s=!e.alternate_subcategory||this.alternateSubcategories.length>0&&this.alternateSubcategories.includes(e.alternate_subcategory);return this.categories.includes(e.category)&&t&&s}loadCategoryModal(){document.querySelectorAll("#categories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#subcategories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#subcategories label").forEach(e=>{e.classList.add("d-none")}),document.querySelectorAll("#alternate-subcategories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#alternate-subcategories label").forEach(e=>{e.classList.add("d-none")}),document.getElementById("subcategory-info-text").classList.toggle("d-none",this.categories.length||this.subcategories.length);for(const e of this.categories){document.getElementById(e).checked=!0;for(const t of d[e])document.querySelector(`[for="${t}"]`).classList.remove("d-none");for(const t of g[e])document.querySelector(`[for="${t}"]`).classList.remove("d-none")}for(const e of this.subcategories)document.getElementById(e).checked=!0;for(const e of this.alternateSubcategories)document.getElementById(e).checked=!0;document.getElementById("non-percent-view").className=this.percentView?"d-none":"row",document.getElementById("percent-view").className=this.percentView?"":"d-none",document.getElementById("toggle-all").disabled=this.percentView;const e=document.querySelectorAll(".category-percent");for(let t=0;t<this.categoryPercents.length;t++)e.item(t).textContent=String(this.categoryPercents[t]).padStart(3," ")+"%"}updateCategory(e){return this.categories.includes(e)?(this.categories=this.categories.filter(t=>t!==e),this.subcategories=this.subcategories.filter(t=>!d[e].includes(t)),this.alternateSubcategories=this.alternateSubcategories.filter(t=>!g[e].includes(t)),!1):(this.categories.push(e),this.subcategories=this.subcategories.concat(d[e]),this.alternateSubcategories=this.alternateSubcategories.concat(g[e]),!0)}updateSubcategory(e){return this.subcategories.includes(e)?(this.subcategories=this.subcategories.filter(t=>t!==e),!1):(this.subcategories.push(e),!0)}updateAlternateSubcategory(e){return this.alternateSubcategories.includes(e)?(this.alternateSubcategories=this.alternateSubcategories.filter(t=>t!==e),!1):(this.alternateSubcategories.push(e),!0)}}class f{constructor(e){this.name=e,this.players={},this.sockets={},this.teams={},this.timer={interval:null,timeRemaining:0}}async message(e,t){throw new Error("Not implemented")}emitMessage(e){e=JSON.stringify(e);for(const t of Object.values(this.sockets))t.send(e)}leave(e){this.players[e].online=!1,delete this.sockets[e];const t=this.players[e].username;this.emitMessage({type:"leave",userId:e,username:t})}sendToSocket(e,t){t=JSON.stringify(t),this.sockets[e].send(t)}setUsername(e,{username:t}){if("string"!=typeof t)return!1;const s=this.players[e].username;this.players[e].username=t,this.emitMessage({type:"set-username",userId:e,oldUsername:s,newUsername:t})}startServerTimer(e,t,s){clearInterval(this.timer.interval),this.timer.timeRemaining=e,this.timer.interval=setInterval(()=>{this.timer.timeRemaining<=0&&(clearInterval(this.timer.interval),s()),t(this.timer.timeRemaining),this.timer.timeRemaining--},100)}}class E extends f{constructor(e,t=[],s=[],n=[]){super(e),this.checkAnswer=function(e,t,s=7){throw new Error("Not implemented")},this.getRandomQuestions=async function(e){throw new Error("Not implemented")},this.getSet=async function(e){throw new Error("Not implemented")},this.getNumPackets=async function(e){throw new Error("Not implemented")},this.getRandomStarredQuestion=async function(){throw new Error("Not implemented")},this.getNextLocalQuestion=function(){throw new Error("Not implemented")},this.categoryManager=new w(t,s,n),this.packetLength=void 0,this.queryingQuestion=!1,this.randomQuestionCache=[],this.setCache=[],this.setLength=24,this.mode=o.mT.RANDOM,this.localQuestions={tossups:[],bonuses:[]},this.query={difficulties:[4,5],minYear:o.jG,maxYear:o.d2,packetNumbers:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],setName:"2023 PACE NSC",alternateSubcategories:n,categories:t,subcategories:s,percentView:!1,categoryPercents:m.map(()=>0),reverse:!0,standardOnly:!1},this.settings={randomizeOrder:!1,strictness:7,skip:!1,timer:!0}}message(e,t){switch(t.type){case"set-categories":return this.setCategories(e,t);case"set-difficulties":return this.setDifficulties(e,t);case"set-mode":return this.setMode(e,t);case"set-packet-numbers":return this.setPacketNumbers(e,t);case"set-set-name":return this.setSetName(e,t);case"set-strictness":return this.setStrictness(e,t);case"set-username":return this.setUsername(e,t);case"set-year-range":return this.setYearRange(e,t);case"toggle-randomize-order":return this.toggleRandomizeOrder(e,t);case"toggle-skip":return this.toggleSkip(e,t);case"toggle-standard-only":return this.toggleStandardOnly(e,t);case"toggle-timer":return this.toggleTimer(e,t);case"upload-local-packet":return this.uploadLocalPacket(e,t)}}async adjustQuery(e,t,s=!1){if(e.length===t.length){for(let s=0;s<e.length;s++){const n=e[s],r=t[s];Object.prototype.hasOwnProperty.call(this.query,n)&&(this.query[n]=r)}if(!s)switch(this.mode){case o.mT.SET_NAME:this.setCache=await this.getSet({setName:this.query.setName,packetNumbers:[this.query.packetNumbers[0]]}),this.packetLength=this.setCache.length;break;case o.mT.RANDOM:this.categoryManager.percentView?this.randomQuestionCache=[]:this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:1})}}}async advanceQuestion(){this.queryingQuestion=!0;let e=null;switch(this.mode){case o.mT.SET_NAME:do{if(0===this.setCache.length){this.query.packetNumbers.shift();const e=this.query.packetNumbers[0];if(void 0===e)return this.emitMessage({type:"end-of-set"}),null;this.setCache=await this.getSet({setName:this.query.setName,packetNumbers:[e]}),this.packetLength=this.setCache.length}if(e=this.setCache.shift(),!e?.packet?.number)return this.emitMessage({type:"no-questions-found"}),null;this.query.packetNumbers=this.query.packetNumbers.filter(t=>t>=e.packet.number)}while(!this.categoryManager.isValidCategory(e));break;case o.mT.RANDOM:if(this.categoryManager.percentView){const e=this.categoryManager.getRandomCategory();this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:1,categories:[e],subcategories:[],alternateSubcategories:[]})}else 0===this.randomQuestionCache.length&&(this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:20}));if(0===this.randomQuestionCache?.length)return this.emitMessage({type:"no-questions-found"}),null;e=this.randomQuestionCache.pop();break;case o.mT.STARRED:do{if(e=await this.getRandomStarredQuestion(),null===e)return this.emitMessage({type:"no-questions-found"}),null}while(!this.categoryManager.isValidCategory(e));break;case o.mT.LOCAL:do{if(e=this.getNextLocalQuestion(),null===e)return this.emitMessage({type:"no-questions-found"}),null}while(!this.categoryManager.isValidCategory(e))}return e}setDifficulties(e,{difficulties:t}){if(t.some(e=>"number"!=typeof e||isNaN(e)||e<0||e>10))return!1;const s=this.players[e].username;this.adjustQuery(["difficulties"],[t]),this.emitMessage({type:"set-difficulties",username:s,difficulties:t})}setMode(e,{mode:t,setName:s}){if(!Object.values(o.mT).includes(t))return;this.mode=t;const n=this.players[e].username;this.emitMessage({type:"set-mode",mode:t,setName:s,username:n})}async setPacketNumbers(e,{doNotFetch:t=!1,packetNumbers:s}){if(!Array.isArray(s))return!1;if(s.some(e=>"number"!=typeof e||e<1||e>this.setLength))return!1;const n=this.players[e].username;this.adjustQuery(["packetNumbers"],[s],t),this.emitMessage({type:"set-packet-numbers",username:n,packetNumbers:s})}async setSetName(e,{doNotFetch:t=!1,setName:s}){if("string"!=typeof s)return;const n=this.players[e].username;this.setLength=await this.getNumPackets(s);const r=[];for(let e=1;e<=this.setLength;e++)r.push(e);this.adjustQuery(["setName","packetNumbers"],[s,r],t),this.emitMessage({type:"set-set-name",username:n,setName:s,setLength:this.setLength})}setStrictness(e,{strictness:t}){this.settings.strictness=t;const s=this.players[e].username;this.emitMessage({type:"set-strictness",username:s,strictness:t})}startServerTimer(e,t,s){this.settings.timer&&super.startServerTimer(e,t,s)}toggleRandomizeOrder(e,{randomizeOrder:t}){this.settings.randomizeOrder=t;const s=this.players[e].username;this.emitMessage({type:"toggle-randomize-order",randomizeOrder:t,username:s})}toggleSkip(e,{skip:t}){this.settings.skip=t;const s=this.players[e].username;this.emitMessage({type:"toggle-skip",skip:t,username:s})}toggleStandardOnly(e,{doNotFetch:t=!1,standardOnly:s}){this.query.standardOnly=s;const n=this.players[e].username;this.adjustQuery(["standardOnly"],[s],t),this.emitMessage({type:"toggle-standard-only",standardOnly:s,username:n})}toggleTimer(e,{timer:t}){this.settings.timer=t;const s=this.players[e].username;this.emitMessage({type:"toggle-timer",timer:t,username:s})}setCategories(e,{categories:t,subcategories:s,alternateSubcategories:n,percentView:r,categoryPercents:a}){if(!Array.isArray(t))return;if(!Array.isArray(s))return;if(!Array.isArray(n))return;if(a?.length!==m.length)return;if(t=t.filter(e=>m.includes(e)),s=s.filter(e=>p.includes(e)),n=n.filter(e=>b.includes(e)),s.some(e=>!t.includes(h[e])))return;if(n.some(e=>!t.includes(y[e])))return;this.categoryManager.import({categories:t,subcategories:s,alternateSubcategories:n,percentView:r,categoryPercents:a});const i=this.players[e].username;this.adjustQuery(["categories","subcategories","alternateSubcategories","percentView","categoryPercents"],[t,s,n,r,a]),this.emitMessage({type:"set-categories",...this.categoryManager.export(),username:i})}setYearRange(e,{minYear:t,maxYear:s}){if(t=parseInt(t),s=parseInt(s),isNaN(t)&&(t=o.jG),isNaN(s)&&(s=o.d2),s<t)this.sendToSocket(e,{type:"set-year-range",minYear:this.query.minYear,maxYear:this.query.maxYear,username:null});else{const n=this.players[e].username;this.adjustQuery(["minYear","maxYear"],[t,s]),this.emitMessage({type:"set-year-range",minYear:t,maxYear:s,username:n})}}uploadLocalPacket(e,{packet:t,filename:s}){if("string"==typeof s&&0!==s.length&&"object"==typeof t&&null!==t&&Object.prototype.hasOwnProperty.call(t,"bonuses")&&Object.prototype.hasOwnProperty.call(t,"tossups")){this.localQuestions.tossups=[],this.localQuestions.bonuses=[];for(const e of["bonuses","tossups"]){const n=t[e];if(!Array.isArray(n))return;const r=s.match(/\d+/),a=parseInt(r?.[0]),i=isNaN(a)?1:a;for(let e=0;e<n.length;e++){const t=n[e];t._id=Math.random().toString(16).slice(2),t.number=e+1,t.packet={number:i},t.set={name:s}}this.localQuestions[e]=n}this.emitMessage({type:"alert",message:`Successfully uploaded ${this.localQuestions.tossups.length} tossups and ${this.localQuestions.bonuses.length} bonuses.`,userId:e})}}}class S extends E{constructor(e,t=[],s=[],n=[]){super(e,t,s,n),this.getNextLocalQuestion=()=>{if(0===this.localQuestions.tossups.length)return null;if(this.settings.randomizeOrder){const e=Math.floor(Math.random()*this.localQuestions.tossups.length);return this.localQuestions.tossups.splice(e,1)[0]}return this.localQuestions.tossups.shift()},this.timeoutID=null,this.buzzedIn=null,this.buzzes=[],this.buzzpointIndices=[],this.liveAnswer="",this.paused=!1,this.questionSplit=[],this.tossup={},this.tossupProgress=o.TX.NOT_STARTED,this.wordIndex=0,this.query={...this.query,powermarkOnly:!1},this.settings={...this.settings,rebuzz:!1,readingSpeed:50},this.previous={celerity:0,endOfQuestion:!1,isCorrect:!0,inPower:!1,negValue:-5,powerValue:15,tossup:{},userId:null}}async message(e,t){switch(t.type){case"buzz":return this.buzz(e,t);case"clear-stats":return this.clearStats(e,t);case"give-answer":return this.giveAnswer(e,t);case"next":case"skip":case"start":return this.next(e,t);case"pause":return this.pause(e,t);case"set-reading-speed":return this.setReadingSpeed(e,t);case"toggle-powermark-only":return this.togglePowermarkOnly(e,t);case"toggle-rebuzz":return this.toggleRebuzz(e,t);default:return super.message(e,t)}}buzz(e){if(!this.settings.rebuzz&&this.buzzes.includes(e))return;if(this.tossupProgress!==o.TX.READING)return;const t=this.players[e].username;this.buzzedIn?this.emitMessage({type:"lost-buzzer-race",userId:e,username:t}):(clearTimeout(this.timeoutID),this.buzzedIn=e,this.buzzes.push(e),this.buzzpointIndices.push(this.questionSplit.slice(0,this.wordIndex).join(" ").length),this.paused=!1,this.emitMessage({type:"buzz",userId:e,username:t}),this.emitMessage({type:"update-question",word:"(#)"}),this.startServerTimer(10*o.BK,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.giveAnswer(e,{givenAnswer:this.liveAnswer})))}clearStats(e){this.players[e].clearStats(),this.emitMessage({type:"clear-stats",userId:e})}giveAnswer(e,{givenAnswer:t}){if("string"!=typeof t)return!1;if(this.buzzedIn!==e)return!1;if(this.liveAnswer="",clearInterval(this.timer.interval),this.emitMessage({type:"timer-update",timeRemaining:10*o.BK}),0===Object.keys(this.tossup||{}).length)return;const{celerity:s,directive:n,directedPrompt:r,points:a}=this.scoreTossup({givenAnswer:t});switch(n){case"accept":this.buzzedIn=null,this.revealQuestion(),this.players[e].updateStats(a,s),Object.values(this.players).forEach(e=>{e.tuh++});break;case"reject":this.buzzedIn=null,this.players[e].updateStats(a,s),this.settings.rebuzz||this.buzzes.length!==Object.keys(this.sockets).length?this.readQuestion(Date.now()):(this.revealQuestion(),Object.values(this.players).forEach(e=>{e.tuh++}));break;case"prompt":this.startServerTimer(10*o.BK,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.giveAnswer(e,{givenAnswer:this.liveAnswer}))}this.emitMessage({type:"give-answer",userId:e,username:this.players[e].username,givenAnswer:t,directive:n,directedPrompt:r,score:a,celerity:this.players[e].celerity.correct.average,tossup:this.tossup,perQuestionCelerity:s})}async next(e,{type:t}){if(this.buzzedIn)return!1;if(this.queryingQuestion)return!1;if(this.tossupProgress===o.TX.READING&&!this.settings.skip)return!1;const s=this.players[e].username;clearInterval(this.timer.interval),this.emitMessage({type:"timer-update",timeRemaining:0}),clearTimeout(this.timeoutID),this.buzzedIn=null,this.buzzes=[],this.buzzpointIndices=[],this.paused=!1,this.tossupProgress!==o.TX.ANSWER_REVEALED&&this.revealQuestion();const n=this.tossup;if(this.tossup=await this.advanceQuestion(),this.queryingQuestion=!1,!this.tossup)return this.emitMessage({type:"end",oldTossup:n,userId:e,username:s}),!1;this.questionSplit=this.tossup.question_sanitized.split(" ").filter(e=>""!==e),this.emitMessage({type:t,packetLength:this.packetLength,oldTossup:n,tossup:this.tossup,userId:e,username:s}),this.wordIndex=0,this.tossupProgress=o.TX.READING,this.readQuestion(Date.now())}pause(e){if(this.buzzedIn)return!1;if(this.tossupProgress===o.TX.ANSWER_REVEALED)return!1;this.paused=!this.paused,this.paused?(clearTimeout(this.timeoutID),clearInterval(this.timer.interval)):this.wordIndex>=this.questionSplit.length?this.startServerTimer(this.timer.timeRemaining,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.revealQuestion()):this.readQuestion(Date.now());const t=this.players[e].username;this.emitMessage({type:"pause",paused:this.paused,username:t})}scoreTossup({givenAnswer:e}){const t=this.questionSplit.slice(this.wordIndex).join(" ").length/this.tossup.question.length,s=this.wordIndex===this.questionSplit.length,n=Math.max(this.questionSplit.indexOf("(*)"),this.questionSplit.indexOf("[*]"))>=this.wordIndex,{directive:r,directedPrompt:a}=this.checkAnswer(this.tossup.answer,e,this.settings.strictness),i="accept"===r,o=i?n?this.previous.powerValue:10:s?0:this.previous.negValue;return this.previous={...this.previous,celerity:t,endOfQuestion:s,inPower:n,isCorrect:i,tossup:this.tossup,userId:this.buzzedIn},{celerity:t,directive:r,directedPrompt:a,endOfQuestion:s,inPower:n,points:o}}setReadingSpeed(e,{readingSpeed:t}){if(isNaN(t))return!1;t>100&&(t=100),t<0&&(t=0),this.settings.readingSpeed=t;const s=this.players[e].username;this.emitMessage({type:"set-reading-speed",username:s,readingSpeed:t})}async readQuestion(e){if(0===Object.keys(this.tossup||{}).length)return;if(this.wordIndex>=this.questionSplit.length)return void this.startServerTimer(10*o.l4,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.revealQuestion());const t=this.questionSplit[this.wordIndex];this.wordIndex++,this.emitMessage({type:"update-question",word:t});let s=Math.log(t.length)+1;t.endsWith(".")&&t.charCodeAt(t.length-2)>96&&t.charCodeAt(t.length-2)<123||".”"===t.slice(-2)||"!”"===t.slice(-2)||"?”"===t.slice(-2)?s+=2:t.endsWith(",")||",”"===t.slice(-2)?s+=.75:"(*)"!==t&&"[*]"!==t||(s=0),s=.9*s*(125-this.settings.readingSpeed);const n=s-Date.now()+e;this.timeoutID=setTimeout(()=>{this.readQuestion(s+e)},n)}revealQuestion(){0!==Object.keys(this.tossup||{}).length&&(this.tossupProgress=o.TX.ANSWER_REVEALED,this.tossup.markedQuestion=u(this.tossup.question,this.tossup.question_sanitized,{" (#) ":this.buzzpointIndices}),this.emitMessage({type:"reveal-answer",question:u(this.tossup.question,this.tossup.question_sanitized,{" (#) ":this.buzzpointIndices}),answer:this.tossup.answer}))}togglePowermarkOnly(e,{powermarkOnly:t}){this.query.powermarkOnly=t;const s=this.players[e].username;this.adjustQuery(["powermarkOnly"],[t]),this.emitMessage({type:"toggle-powermark-only",powermarkOnly:t,username:s})}toggleRebuzz(e,{rebuzz:t}){this.settings.rebuzz=t;const s=this.players[e].username;this.emitMessage({type:"toggle-rebuzz",rebuzz:t,username:s})}}let v=null;async function I(){if(null===v){if(v=await fetch("/auth/stars/tossup-ids").then(e=>e.ok?e.json():null),null===v)return null;v.sort(()=>Math.random()-.5)}if(0===v.length)return null;const e=v.pop();return await l.getTossupById(e)}class k extends S{constructor(e,t=[],s=[],n=[]){super(e,t,s,n),this.settings={...this.settings,aiMode:!1,skip:!0,showHistory:!0,typeToAnswer:!0},this.checkAnswer=l.checkAnswer,this.getRandomQuestions=async e=>await l.getRandomTossup({...e}),this.getSet=async({setName:e,packetNumbers:t})=>e?await l.getPacketTossups(e,t[0]??1):[],this.getRandomStarredQuestion=I,this.getNumPackets=l.getNumPackets}async message(e,t){switch(t.type){case"toggle-ai-mode":return this.toggleAiMode(e,t);case"toggle-correct":return this.toggleCorrect(e,t);case"toggle-show-history":return this.toggleShowHistory(e,t);case"toggle-type-to-answer":return this.toggleTypeToAnswer(e,t);default:super.message(e,t)}}buzz(e){this.settings.typeToAnswer||!this.buzzes.includes(e)?super.buzz(e):this.giveAnswer(e,{givenAnswer:this.tossup.answer_sanitized})}get liveAnswer(){return document.getElementById("answer-input").value}set liveAnswer(e){document.getElementById("answer-input").value=e}toggleAiMode(e,{aiMode:t}){this.settings.aiMode=t,this.emitMessage({type:"toggle-ai-mode",aiMode:t,userId:e})}toggleCorrect(e,{correct:t}){if(e!==this.previous.userId)return;this.previous.isCorrect=t;const s=t?1:-1;this.previous.inPower?(this.players[e].powers+=1*s,this.players[e].points+=s*this.previous.powerValue):(this.players[e].tens+=1*s,this.players[e].points+=10*s),this.previous.endOfQuestion?this.players[e].dead+=-1*s:(this.players[e].negs+=-1*s,this.players[e].points+=s*-this.previous.negValue),this.players[e].celerity.correct.total+=s*this.previous.celerity,this.players[e].celerity.correct.average=this.players[e].celerity.correct.total/(this.players[e].powers+this.players[e].tens),this.emitMessage({type:"toggle-correct",correct:t,userId:e})}toggleShowHistory(e,{showHistory:t}){this.settings.showHistory=t,this.emitMessage({type:"toggle-show-history",showHistory:t,userId:e})}toggleTypeToAnswer(e,{typeToAnswer:t}){this.settings.typeToAnswer=t,this.emitMessage({type:"toggle-type-to-answer",typeToAnswer:t,userId:e})}}},107:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(685);class r{static starredSvg='<i class="bi bi-star-fill"></i>';static unstarredSvg='<i class="bi bi-star"></i>';static async starBonus(e){return fetch("/auth/stars/star-bonus",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({bonus_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error starring the bonus."),e.ok)).catch(e=>(window.alert("There was an error starring the bonus."),!1))}static async starTossup(e){return fetch("/auth/stars/star-tossup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tossup_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error starring the bonus."),e.ok)).catch(e=>(window.alert("There was an error starring the bonus."),!1))}static async unstarBonus(e){return fetch("/auth/stars/unstar-bonus",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({bonus_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error unstarring the bonus."),e.ok)).catch(e=>(window.alert("There was an error unstarring the bonus."),!1))}static async unstarTossup(e){return fetch("/auth/stars/unstar-tossup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tossup_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error unstarring the bonus."),e.ok)).catch(e=>(window.alert("There was an error unstarring the bonus."),!1))}static async isStarredBonus(e){return!!await n.A.getUsername()&&await fetch(`/auth/stars/is-starred-bonus?bonus_id=${e}`).then(e=>e.json()).then(e=>e.isStarred).catch(e=>!1)}static async isStarredTossup(e){return!!await n.A.getUsername()&&await fetch(`/auth/stars/is-starred-tossup?tossup_id=${e}`).then(e=>e.json()).then(e=>e.isStarred).catch(e=>!1)}static async getStarredTossups(){return await fetch("/auth/stars/tossups").then(e=>e.json()).then(e=>e)}static async getStarredBonuses(){return await fetch("/auth/stars/bonuses").then(e=>e.json()).then(e=>e)}static async getStarredTossupIds(){return await n.A.getUsername()?await fetch("/auth/stars/tossup-ids").then(e=>e.json()).then(e=>e):[]}static async getStarredBonusIds(){return await n.A.getUsername()?await fetch("/auth/stars/bonus-ids").then(e=>e.json()).then(e=>e):[]}static async clearStarredTossups(){const e=await fetch("/auth/stars/clear-tossup-stars",{method:"DELETE",headers:{"Content-Type":"application/json"}});e.ok||window.alert("There was an error clearing starred tossups.");const{count:t}=await e.json();t&&window.alert(`Cleared ${t} starred tossups.`)}static async clearStarredBonuses(){const e=await fetch("/auth/stars/clear-bonus-stars",{method:"DELETE",headers:{"Content-Type":"application/json"}});e.ok||window.alert("There was an error clearing starred bonuses.");const{count:t}=await e.json();t&&window.alert(`Cleared ${t} starred bonuses.`)}}var a=s(412);async function i({roomHistoryId:e="room-history",starred:t,tossup:s}){if(!s||0===Object.keys(s).length)return;const{markedQuestion:n,answer:i,category:o,subcategory:c,alternate_subcategory:l,set:u,packet:d,number:m,_id:g}=s;t=t??await r.isStarredTossup(g);const h=document.createElement("div");h.className="card my-2",h.innerHTML=`\n    <div class="card-header d-flex justify-content-between">\n      <span class="card-header-clickable clickable" data-bs-toggle="collapse" data-bs-target="#question-${g}" aria-expanded="true">\n        ${(0,a.$)(i)}\n      </span>\n      <a href="#" class="star-tossup ${t?"selected":""}" id="star-tossup-${g}">\n        ${t?r.starredSvg:r.unstarredSvg}\n      </a>\n    </div>\n    <div class="card-container collapse" id="question-${g}">\n      <div class="card-body">\n        ${n}\n        <a class="user-select-none" href="#" id="report-question-${g}" data-bs-toggle="modal" data-bs-target="#report-question-modal">Report Question</a>\n        <hr></hr>\n        <div>ANSWER: ${i}</div>\n      </div>\n      <div class="card-footer">\n        <small class="text-muted">${u.name} / ${o} / ${c}${l?" / "+l:""}</small>\n        <small class="text-muted float-end">Packet ${d.number} / Question ${m}</small>\n      </div>\n    </div>\n  `,document.getElementById(e).prepend(h),document.getElementById("report-question-"+g).addEventListener("click",function(){document.getElementById("report-question-id").value=g}),document.getElementById("star-tossup-"+g).addEventListener("click",async function(e){e.preventDefault(),e.stopPropagation(),this.classList.contains("selected")?(this.innerHTML=r.unstarredSvg,r.unstarTossup(g),this.classList.remove("selected")):await r.starTossup(g)&&(this.innerHTML=r.starredSvg,this.classList.add("selected"))})}},118:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>u});var r=s(837),a=s(685),i=s(599),o=s(994),c=s(36);const l=await(0,c.A)();class u{constructor(e,t){this.room=e,this.USER_ID=t,this.SET_LIST=l,document.getElementById("set-list").innerHTML=this.SET_LIST.map(e=>`<option>${e}</option>`).join("")}onmessage(e){const t=JSON.parse(e);switch(t.type){case"alert":return window.alert(t.message);case"end":case"next":case"skip":case"start":return this.next(t);case"end-of-set":return this.endOfSet(t);case"give-answer":return this.giveAnswer(t);case"no-questions-found":return this.noQuestionsFound(t);case"set-categories":return this.setCategories(t);case"set-difficulties":return this.setDifficulties(t);case"set-mode":return this.setMode(t);case"set-packet-numbers":return this.setPacketNumbers(t);case"set-set-name":return this.setSetName(t);case"set-strictness":return this.setStrictness(t);case"set-year-range":return this.setYearRange(t);case"timer-update":return this.timerUpdate(t);case"toggle-standard-only":return this.toggleStandardOnly(t);case"toggle-timer":return this.toggleTimer(t)}}endOfSet(){window.alert("You have reached the end of the set")}giveAnswer({directive:e,directedPrompt:t,score:s,userId:n}){document.getElementById("answer-input").value="",document.getElementById("answer-input").blur(),document.getElementById("answer-input").placeholder="Enter answer",document.getElementById("answer-input-group").classList.add("d-none"),"prompt"===e&&n===this.USER_ID&&(document.getElementById("answer-input-group").classList.remove("d-none"),document.getElementById("answer-input").focus(),document.getElementById("answer-input").placeholder=t?`Prompt: "${t}"`:"Prompt"),i.A.soundEffects&&n===this.USER_ID&&("accept"===e&&s&&s>10?i.A.power.play():"accept"===e?i.A.correct.play():"reject"===e&&i.A.incorrect.play())}next({type:e,nextQuestion:t,packetLength:s}){document.getElementById("question").textContent="",document.getElementById("settings").classList.add("d-none"),"end"!==e&&(document.getElementById("packet-length-info").textContent=this.room.mode===r.mT.SET_NAME?s:"-",document.getElementById("packet-number-info").textContent=t.packet.number,document.getElementById("set-name-info").textContent=t.set.name,document.getElementById("question-number-info").textContent=t.number)}noQuestionsFound(){window.alert("No questions found")}setCategories(){this.room.categoryManager.loadCategoryModal()}setDifficulties(){throw new Error("Not implemented")}setMode({mode:e}){switch(document.getElementById("set-mode").value=e,e){case r.mT.SET_NAME:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("set-settings").classList.remove("d-none");break;case r.mT.RANDOM:document.getElementById("difficulty-settings").classList.remove("d-none"),document.getElementById("set-settings").classList.add("d-none")}}setPacketNumbers({packetNumbers:e}){document.getElementById("packet-number").value=(0,o.w)(e)}setSetName({setName:e,setLength:t}){document.getElementById("set-name").value=e;const s=!e||this.SET_LIST.includes(e);document.getElementById("packet-number").placeholder="Packet Numbers"+(t?` (1-${t})`:""),document.getElementById("set-name").classList.toggle("is-invalid",!s)}setStrictness({strictness:e}){document.getElementById("set-strictness").value=e,document.getElementById("strictness-display").textContent=e}setYearRange({minYear:e,maxYear:t}){$("#slider").slider("values",[e,t]),document.getElementById("year-range-a").textContent=e,document.getElementById("year-range-b").textContent=t}timerUpdate({timeRemaining:e}){const t=Math.floor(e/10),s=e%10;document.querySelector(".timer .face").textContent=t,document.querySelector(".timer .fraction").textContent="."+s}toggleStandardOnly({standardOnly:e}){document.getElementById("toggle-standard-only").checked=e}toggleTimer({timer:e}){document.getElementById("timer").classList.toggle("d-none",!e),document.getElementById("toggle-timer").checked=e}}const d=window.localStorage.getItem("font-size");function m(){if(window.navigator.userAgent.match(/Mobile.*Firefox/)){const e=document.getElementById("set-name");e.addEventListener("input",function(){document.getElementById("set-dropdown")?.remove();const t=this.value.toLowerCase(),s=l.filter(e=>e.toLowerCase().includes(t)).map(e=>`<a class="dropdown-item" onclick="fillSetName(event)">${e}</a>`).join(""),n=""===s?"":`\n        <div id="set-dropdown" class="dropdown-menu" style="display: inline" aria-labelledby="set-name">\n            ${s}\n        </div>\n        `;e.insertAdjacentHTML("afterend",n)}),e.addEventListener("blur",function(){document.getElementById("set-dropdown")?.remove()})}}d&&document.getElementById("question").style.setProperty("font-size",`${d}px`),"true"===window.localStorage.getItem("high-contrast-question-text")&&document.getElementById("question").classList.add("high-contrast-question-text"),m();const g={};a.A.getUsername().then(e=>{const t=new bootstrap.Toast(document.getElementById("funny-toast")),s=document.getElementById("funny-toast-text");e in g&&(s.textContent=g[e],t.show())}),document.querySelectorAll("span.default-min-year").forEach(e=>{e.textContent=r.jG}),document.querySelectorAll("span.default-max-year").forEach(e=>{e.textContent=r.d2});const h=[];document.body.onmouseup=function(){for(let e=0;e<h.length;++e)h[e].onchange&&h[e].onchange();h.length=0},$("#slider").slider({min:r.zN,max:r.d2,step:1,values:[r.jG,r.d2],slide:function(e,t){for(let e=0;e<t.values.length;++e)$(`span.sliderValue${e}`)[0].textContent=t.values[e],h.includes($(`span.sliderValue${e}`)[0])||h.push($(`span.sliderValue${e}`)[0])}}),document.getElementById("slider").classList.remove("ui-widget-content"),document.getElementById("slider").classList.remove("ui-widget"),$("input.sliderValue").change(function(){const e=$(this);$("#slider").slider("values",e.data("index"),e.val())}),n()}catch(p){n(p)}},1)},267:(e,t,s)=>{s.d(t,{A:()=>i});const n=[["Literature","primary"],["History","success"],["Science","danger"],["Fine Arts","warning"],["Religion","secondary"],["Mythology","secondary"],["Philosophy","secondary"],["Social Science","secondary"],["Current Events","secondary"],["Geography","secondary"],["Other Academic","secondary"],["Pop Culture","secondary"]],r=[["American Literature","primary"],["British Literature","primary"],["Classical Literature","primary"],["European Literature","primary"],["World Literature","primary"],["Other Literature","primary"],["American History","success"],["Ancient History","success"],["European History","success"],["World History","success"],["Other History","success"],["Biology","danger"],["Chemistry","danger"],["Physics","danger"],["Other Science","danger"],["Visual Fine Arts","warning"],["Auditory Fine Arts","warning"],["Other Fine Arts","warning"],["Movies","secondary"],["Music","secondary"],["Sports","secondary"],["Television","secondary"],["Video Games","secondary"],["Other Pop Culture","secondary"]],a=[["Drama","primary"],["Long Fiction","primary"],["Poetry","primary"],["Short Fiction","primary"],["Misc Literature","primary"],["Math","danger"],["Astronomy","danger"],["Computer Science","danger"],["Earth Science","danger"],["Engineering","danger"],["Misc Science","danger"],["Architecture","warning"],["Dance","warning"],["Film","warning"],["Jazz","warning"],["Musicals","warning"],["Opera","warning"],["Photography","warning"],["Misc Arts","warning"],["Anthropology","secondary"],["Economics","secondary"],["Linguistics","secondary"],["Psychology","secondary"],["Sociology","secondary"],["Other Social Science","secondary"]],i=function({categoryManager:e,disablePercentView:t=!1,onClose:s=()=>{}}){function i({category:t,index:s}){function n(t){const n=Math.min(100,Math.max(0,e.categoryPercents[s]+t));e.categoryPercents[s]=n,e.loadCategoryModal()}return React.createElement("tr",null,React.createElement("th",{style:{width:"50%"}},t),React.createElement("td",{style:{width:"50%"}},React.createElement("span",{className:"font-monospace me-1 category-percent"}),React.createElement("div",{className:"btn-group btn-group-sm me-1",role:"group"},React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(-5)},"-"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(5)},"+")),React.createElement("div",{className:"btn-group btn-group-sm",role:"group"},React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(-100)},"Min"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(50-e.categoryPercents[s])},"50%"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(100-e.categoryPercents.reduce((e,t)=>e+t))},"Max"))))}function o({category:t,color:s}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateCategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1`,htmlFor:t},t,React.createElement("br",null)))}function c({subcategory:t,color:s,hidden:n=!1}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateSubcategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1 ${n&&"d-none"}`,htmlFor:t},t,React.createElement("br",null)))}function l({subcategory:t,color:s,hidden:n=!1}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateAlternateSubcategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1 ${n&&"d-none"}`,htmlFor:t},t,React.createElement("br",null)))}return React.useEffect(()=>{e.loadCategoryModal(),document.getElementById("category-modal").addEventListener("hidden.bs.modal",s)},[s]),React.createElement("div",{className:"modal modal-lg",id:"category-modal",tabIndex:"-1"},React.createElement("div",{className:"modal-dialog modal-dialog-scrollable"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h5",{className:"modal-title me-2"},"Select Categories"),React.createElement(function(){return React.createElement("button",{className:"btn btn-primary me-1",id:"toggle-all",onClick:function(){0===e.categories.length?e.import({categories:n.map(e=>e[0]),subcategories:r.map(e=>e[0]),alternateSubcategories:a.map(e=>e[0])}):e.import(),e.loadCategoryModal()}},"Toggle all")},null),t||React.createElement(function(){return React.createElement("button",{className:"btn btn-primary",onClick:function(){e.percentView=!e.percentView,e.loadCategoryModal()}},"% view")},null),React.createElement("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"row",id:"non-percent-view"},React.createElement("div",{className:"col-4",id:"categories"},React.createElement("h5",{className:"text-center"},"Category"),n.map(e=>React.createElement(o,{key:e[0],category:e[0],color:e[1]}))),React.createElement("div",{className:"col-4",id:"subcategories"},React.createElement("h5",{className:"text-center"},"Subcategory"),React.createElement("div",{className:"text-muted text-center",id:"subcategory-info-text"},"You must select categories before you can select subcategories."),r.map(e=>React.createElement(c,{key:e[0],subcategory:e[0],color:e[1],hidden:!0}))),React.createElement("div",{className:"col-4",id:"alternate-subcategories"},React.createElement("h5",{className:"text-center"},"Alternate ",React.createElement("span",{className:"d-none d-lg-inline"},"Subcategory")),a.map(e=>React.createElement(l,{key:e[0],subcategory:e[0],color:e[1],hidden:!0})))),React.createElement("div",{className:"d-none",id:"percent-view"},React.createElement("table",{className:"table"},React.createElement("tbody",null,n.map((e,t)=>React.createElement(i,{key:e[0],category:e[0],index:t})),React.createElement("tr",null,React.createElement("th",null,"Total Percent:"),React.createElement("td",{className:"font-monospace"},React.createElement("span",{className:"me-1"},(e.categoryPercents.reduce((e,t)=>e+t,0)+"").padStart(3," "),"%"),React.createElement("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>{e.categoryPercents=e.categoryPercents.map(()=>0),e.loadCategoryModal()}},"Reset"))))))))))}},280:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(287);class r{constructor(e,t="ai-bot"){this.room=e,this.player=new n.A(t),this.player.username=t,this.socket={send:this.onmessage.bind(this),sendToServer:s=>e.message(t,s)},this.active=!0,this.tossup={},this.wordIndex=0}onmessage(e){const t=JSON.parse(e);switch(t.type){case"start":case"skip":case"next":return this.next(t);case"update-question":return this.updateQuestion(t)}}get active(){return this._active}set active(e){this._active=e,this._active?(this.room.players[this.player.userId]=this.player,this.room.sockets[this.player.userId]=this.socket):this.room.leave(this.player.userId)}sendBuzz({correct:e}){this.active&&setTimeout(()=>{this.socket.sendToServer({type:"buzz"}),setTimeout(()=>this.socket.sendToServer({type:"give-answer",givenAnswer:e?this.tossup.answer_sanitized:""}),1e3)},50)}calculateBuzzpoint({packetLength:e,oldTossup:t,tossup:s}){throw new Error("calculateBuzzpoint not implemented")}next({packetLength:e,oldTossup:t,tossup:s}){this.tossup=s,this.wordIndex=0,({buzzpoint:this.buzzpoint,correctBuzz:this.correctBuzz}=this.calculateBuzzpoint({packetLength:e,oldTossup:t,tossup:s}))}setAIBot(e){this.calculateBuzzpoint=e}updateQuestion({word:e}){if(this.wordIndex++,this.wordIndex===this.buzzpoint)return this.sendBuzz({correct:this.correctBuzz})}}},283:(e,t,s)=>{function n(e,t,s){document.getElementById("report-question-submit").disabled=!0,fetch("/api/report-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,reason:t,description:s})}).then(e=>{200===e.status?(document.getElementById("report-question-reason").value="wrong-category",document.getElementById("report-question-description").value="",window.alert("Question has been reported.")):window.alert("There was an error reporting the question.")}).catch(e=>{window.alert("There was an error reporting the question.")}).finally(()=>{document.getElementById("report-question-close").click(),document.getElementById("report-question-submit").disabled=!1})}s.d(t,{A:()=>n})},287:(e,t,s)=>{s.d(t,{A:()=>n});const n=class{constructor(e,t=void 0){this.userId=e,this.MAX_USERNAME_LENGTH=t,this.teamId=void 0,this.username="",this.powers=0,this.tens=0,this.zeroes=0,this.negs=0,this.points=0,this.tuh=0,this.celerity={all:{total:0,average:0},correct:{total:0,average:0}}}clearStats(){this.powers=0,this.tens=0,this.zeroes=0,this.negs=0,this.points=0,this.tuh=0,this.celerity={all:{total:0,average:0},correct:{total:0,average:0}}}updateStats(e,t){this.points+=e,this.celerity.all.total+=t,this.celerity.all.average=this.celerity.all.total/this.tuh,e>10?this.powers++:10===e?this.tens++:0===e?this.zeroes++:e<0&&this.negs++,e>0&&(this.celerity.correct.total+=t,this.celerity.correct.average=this.celerity.correct.total/(this.powers+this.tens))}safelySetUsername(e){return e||(e=""),e=e.substring(0,this.MAX_USERNAME_LENGTH),this.username=e,this.username}}},355:(e,t,s)=>{s.a(e,async(e,t)=>{try{var n=s(287),r=s(283),a=s(994),i=s(828),o=s(267),c=s(955),l=s(619),u=s(280),d=s(57),m=s(764),g=e([m]);m=(g.then?(await g)():g)[0];const h="2025-01-14",p="2025-05-07",y="2024-10-16",b="user",w=new d.A;w.players[b]=new n.A(b);const f=new u.A(w);f.setAIBot(l.A["average-high-school"][0]),f.active=!1;const E=new m.A(w,b,f),S={send:e=>E.onmessage(e),sendToServer:e=>w.message(b,e)};if(w.sockets[b]=S,document.getElementById("answer-form").addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation();const t=document.getElementById("answer-input").value;S.sendToServer({type:"give-answer",givenAnswer:t})}),document.getElementById("buzz").addEventListener("click",function(){this.blur(),S.sendToServer({type:"buzz"})}),document.getElementById("choose-ai").addEventListener("change",function(){const e=this.querySelector("input:checked").id.slice(10);f.setAIBot(l.A[e][0])}),document.getElementById("clear-stats").addEventListener("click",function(){this.blur(),S.sendToServer({type:"clear-stats"})}),document.getElementById("local-packet-input").addEventListener("change",function(){const e=this.files[0];if(e){const t=new window.FileReader;t.onload=function(t){try{const s=JSON.parse(t.target.result);S.sendToServer({type:"upload-local-packet",packet:s,filename:e.name})}catch(e){window.alert("Invalid packet format")}},t.readAsText(e)}}),document.getElementById("next").addEventListener("click",function(){this.blur(),"Skip"===this.innerHTML?S.sendToServer({type:"skip"}):S.sendToServer({type:"next"})}),document.getElementById("packet-number").addEventListener("change",function(){const e=(0,a.A)(this.value.trim(),w.setLength);return e.some(e=>1>e||e>w.setLength)?void document.getElementById("packet-number").classList.add("is-invalid"):(document.getElementById("packet-number").classList.remove("is-invalid"),void S.sendToServer({type:"set-packet-numbers",packetNumbers:e}))}),document.getElementById("pause").addEventListener("click",function(){this.blur();const e=parseFloat(document.querySelector(".timer .face").textContent),t=parseFloat(document.querySelector(".timer .fraction").textContent);S.sendToServer({type:"pause",pausedTime:10*(e+t)})}),document.getElementById("reading-speed").addEventListener("change",function(){S.sendToServer({type:"set-reading-speed",readingSpeed:this.value})}),document.getElementById("report-question-submit").addEventListener("click",function(){(0,r.A)(document.getElementById("report-question-id").value,document.getElementById("report-question-reason").value,document.getElementById("report-question-description").value)}),document.getElementById("set-mode").addEventListener("change",function(){this.blur(),S.sendToServer({type:"set-mode",mode:this.value})}),document.getElementById("set-name").addEventListener("change",function(){S.sendToServer({type:"set-set-name",setName:this.value.trim()})}),document.getElementById("set-strictness").addEventListener("change",function(){this.blur(),S.sendToServer({type:"set-strictness",strictness:this.value})}),document.getElementById("set-strictness").addEventListener("input",function(){document.getElementById("strictness-display").textContent=this.value}),document.getElementById("start").addEventListener("click",function(){S.sendToServer({type:"start"})}),document.getElementById("toggle-ai-mode").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-ai-mode",aiMode:this.checked})}),document.getElementById("toggle-correct").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-correct",correct:"I was right"===this.textContent})}),document.getElementById("toggle-powermark-only").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-powermark-only",powermarkOnly:this.checked})}),document.getElementById("toggle-randomize-order").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-randomize-order",randomizeOrder:this.checked})}),document.getElementById("toggle-rebuzz").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-rebuzz",rebuzz:this.checked})}),document.getElementById("toggle-settings").addEventListener("click",function(){this.blur(),document.getElementById("buttons").classList.toggle("col-lg-9"),document.getElementById("buttons").classList.toggle("col-lg-12"),document.getElementById("content").classList.toggle("col-lg-9"),document.getElementById("content").classList.toggle("col-lg-12"),document.getElementById("settings").classList.toggle("d-none"),document.getElementById("settings").classList.toggle("d-lg-none")}),document.getElementById("toggle-show-history").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-show-history",showHistory:this.checked})}),document.getElementById("toggle-standard-only").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-standard-only",standardOnly:this.checked})}),document.getElementById("toggle-timer").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-timer",timer:this.checked})}),document.getElementById("type-to-answer").addEventListener("click",function(){this.blur(),S.sendToServer({type:"toggle-type-to-answer",typeToAnswer:this.checked})}),document.getElementById("year-range-a").onchange=function(){const e=$("#slider").slider("values",0),t=$("#slider").slider("values",1);S.sendToServer({type:"set-year-range",minYear:e,maxYear:t})},document.getElementById("year-range-b").onchange=function(){const e=$("#slider").slider("values",0),t=$("#slider").slider("values",1);S.sendToServer({type:"set-year-range",minYear:e,maxYear:t})},document.addEventListener("keydown",e=>{if(!["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName))switch(e.key?.toLowerCase()){case" ":document.getElementById("buzz").click(),e.target===document.body&&e.preventDefault();break;case"e":return document.getElementById("toggle-settings").click();case"k":return document.getElementsByClassName("card-header-clickable")[0].click();case"n":return document.getElementById("next").click();case"p":return document.getElementById("pause").click();case"s":return document.getElementById("start").click();case"t":return document.getElementsByClassName("star-tossup")[0].click();case"y":return navigator.clipboard.writeText(w.tossup._id??"")}}),window.localStorage.getItem("singleplayer-tossup-mode"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-tossup-mode"));if(e.version!==h)throw new Error;S.sendToServer({type:"set-mode",...e})}catch{window.localStorage.removeItem("singleplayer-tossup-mode")}let v=[];if(window.localStorage.getItem("singleplayer-tossup-query"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-tossup-query"));if(e.version!==p)throw new Error;w.categoryManager.import(e),w.query=e,S.sendToServer({type:"set-packet-numbers",...e,doNotFetch:!0}),S.sendToServer({type:"set-set-name",...e,doNotFetch:!0}),S.sendToServer({type:"toggle-standard-only",...e,doNotFetch:!0}),S.sendToServer({type:"toggle-powermark-only",...e}),v=e.difficulties}catch{window.localStorage.removeItem("singleplayer-tossup-query")}if($(document).ready(function(){try{const e=JSON.parse(window.localStorage.getItem("singleplayer-tossup-query"));S.sendToServer({type:"set-year-range",...e})}catch{}}),window.localStorage.getItem("singleplayer-tossup-settings"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-tossup-settings"));if(e.version!==y)throw new Error;S.sendToServer({type:"set-strictness",...e}),S.sendToServer({type:"set-reading-speed",...e}),S.sendToServer({type:"toggle-ai-mode",...e}),S.sendToServer({type:"toggle-rebuzz",...e}),S.sendToServer({type:"toggle-show-history",...e}),S.sendToServer({type:"toggle-timer",...e}),S.sendToServer({type:"toggle-type-to-answer",...e})}catch{window.localStorage.removeItem("singleplayer-tossup-settings")}ReactDOM.createRoot(document.getElementById("category-modal-root")).render(React.createElement(o.A,{categoryManager:w.categoryManager,onClose:()=>S.sendToServer({type:"set-categories",...w.categoryManager.export()})})),ReactDOM.createRoot(document.getElementById("difficulty-dropdown-root")).render(React.createElement(c.A,{startingDifficulties:v??[],onChange:()=>S.sendToServer({type:"set-difficulties",difficulties:(0,i.cl)("difficulties")})})),t()}catch(e){t(e)}})},412:(e,t,s)=>{function n(e){return e?.replaceAll("&","&amp;")?.replaceAll("<","&lt;")?.replaceAll(">","&gt;")?.replaceAll('"',"&quot;")?.replaceAll("'","&#039;")}function r(e){return e.replace(/\[[^\]]*\]/g,"").replace(/\([^)]*\)/g,"").trim()}s.d(t,{$:()=>r,Zn:()=>n})},496:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(685);class r{static async recordBonus({_id:e,pointsPerPart:t}){await n.A.getUsername()&&fetch("/auth/question-stats/record-bonus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,pointsPerPart:t})}).then(e=>{if(401===e.status)throw n.A.deleteUsername(),new Error("Unauthenticated")})}static async recordTossup({_id:e,celerity:t,isCorrect:s,multiplayer:r,pointValue:a}){await n.A.getUsername()&&fetch("/auth/question-stats/record-tossup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,isCorrect:s,pointValue:a,celerity:t,multiplayer:r})}).then(e=>{if(401===e.status)throw n.A.deleteUsername(),new Error("Unauthenticated")})}}},528:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>l});var r=s(599),a=s(837),i=s(107),o=s(118),c=e([o]);o=(c.then?(await c)():c)[0];class l extends o.A{onmessage(e){const t=JSON.parse(e);switch(t.type){case"buzz":return this.buzz(t);case"pause":return this.pause(t);case"reveal-answer":return this.revealAnswer(t);case"set-reading-speed":return this.setReadingSpeed(t);case"toggle-powermark-only":return this.togglePowermarkOnly(t);case"toggle-rebuzz":return this.toggleRebuzz(t);case"update-question":return this.updateQuestion(t);default:return super.onmessage(e)}}buzz({userId:e}){document.getElementById("buzz").disabled=!0,document.getElementById("next").disabled=!0,document.getElementById("pause").disabled=!0,e===this.USER_ID&&r.A.soundEffects&&r.A.buzz.play()}giveAnswer({directive:e,directedPrompt:t,score:s,userId:n}){super.giveAnswer({directive:e,directedPrompt:t,score:s,userId:n}),"prompt"!==e&&(document.getElementById("next").disabled=!1)}next({nextTossup:e,oldTossup:t,packetLength:s,starred:n,type:r}){super.next({nextQuestion:e,packetLength:s,type:r}),document.getElementById("answer").textContent="","start"!==r&&(0,i.A)({starred:n,tossup:t}),"end"===r?document.getElementById("buzz").disabled=!0:(document.getElementById("buzz").textContent="Buzz",document.getElementById("buzz").disabled=!1,document.getElementById("pause").textContent="Pause",document.getElementById("pause").disabled=!1)}pause({paused:e}){document.getElementById("pause").textContent=e?"Resume":"Pause"}revealAnswer({answer:e,question:t}){document.getElementById("question").innerHTML=t,document.getElementById("answer").innerHTML="ANSWER: "+e,document.getElementById("pause").disabled=!0}setMode({mode:e}){switch(super.setMode({mode:e}),e){case a.mT.SET_NAME:document.getElementById("toggle-powermark-only").disabled=!0,document.getElementById("toggle-standard-only").disabled=!0;break;case a.mT.RANDOM:document.getElementById("toggle-powermark-only").disabled=!1,document.getElementById("toggle-standard-only").disabled=!1}}setReadingSpeed({readingSpeed:e}){document.getElementById("reading-speed").value=e,document.getElementById("reading-speed-display").textContent=e}togglePowermarkOnly({powermarkOnly:e}){document.getElementById("toggle-powermark-only").checked=e}toggleRebuzz({rebuzz:e}){document.getElementById("toggle-rebuzz").checked=e}updateQuestion({word:e}){"(*)"!==e&&"[*]"!==e&&(document.getElementById("question").innerHTML+=e+" ")}}n()}catch(e){n(e)}})},599:(e,t,s)=>{s.d(t,{A:()=>n});class n{static soundEffects="true"===window.localStorage.getItem("sound-effects");static buzz=new Audio("/audio/buzz.mp3");static correct=new Audio("/audio/correct.mp3");static incorrect=new Audio("/audio/incorrect.mp3");static power=new Audio("/audio/power.mp3")}},619:(e,t,s)=>{function n({correct:e,incorrect:t}){const s={correct:e.reduce((e,t)=>e+t,0),incorrect:t.reduce((e,t)=>e+t,0)},n=Math.random()<s.correct/(s.correct+s.incorrect),r=n?e:t,a=n?s.correct:s.incorrect;let i=Math.random()*a,o=0;for(let e=0;e<r.length;e++)if(i-=r[e],i<=0){o=e/(r.length-1);break}return{correctBuzz:n,celerity:o}}s.d(t,{A:()=>a});const r={"average-high-school":[({packetLength:e,oldTossup:t,tossup:s})=>{const{correctBuzz:r,celerity:a}=n({correct:[46518,49312,59738,60321,58337,57581,58921,60667,59449,57866,57030,55423,53349,48334,40934,37458,37758,27999,7028,2765,3],incorrect:[13627,16145,19896,20840,21156,22286,23431,24927,25800,26522,27485,26590,24989,21843,18291,16705,14712,8616,2715,3560,30]});return{buzzpoint:Math.floor((1-a)*s.question_sanitized.split(" ").length),correctBuzz:r}},"Average high school player on qbreader"],"average-middle-school":[({packetLength:e,oldTossup:t,tossup:s})=>{const{correctBuzz:r,celerity:a}=n({correct:[11337,12754,13830,15806,16889,17129,17422,17639,18710,19444,20610,20667,20683,20837,22565,25328,23742,12888,2407,787,0],incorrect:[2897,3526,3983,4645,4866,5218,5427,5587,6084,6139,6429,6462,6217,6416,6400,6360,4971,2368,1037,1581,12]});return{buzzpoint:Math.floor((1-a)*(s.question_sanitized.split(" ").length-2)),correctBuzz:r}},"Average middle school player on qbreader"],"average-college":[({packetLength:e,oldTossup:t,tossup:s})=>{const{correctBuzz:r,celerity:a}=n({correct:[16918,19378,23738,22743,21767,21490,21992,21339,20742,19685,19008,17198,15972,14190,11492,9608,9207,7242,1809,218,0],incorrect:[4133,5332,6744,6869,6890,7650,7942,8229,8429,8418,8396,7742,6826,5653,4623,3802,3291,2073,689,872,2]});return{buzzpoint:Math.floor((1-a)*(s.question_sanitized.split(" ").length-1)),correctBuzz:r}},"Average college player on qbreader"],"average-open":[({packetLength:e,oldTossup:t,tossup:s})=>{const{correctBuzz:r,celerity:a}=n({correct:[3584,3744,4005,3407,3128,2907,2588,2371,2219,2139,1895,1671,1482,1348,1149,958,892,807,310,94,0],incorrect:[1207,1466,1530,1477,1566,1526,1372,1437,1335,1233,1173,1051,912,751,598,489,404,326,169,201,0]});return{buzzpoint:Math.floor((1-a)*(s.question_sanitized.split(" ").length-1)),correctBuzz:r}},"Average open player on qbreader"],"right-after-power":[({packetLength:e,oldTossup:t,tossup:s})=>{let n=Math.max(s.question_sanitized.split(" ").indexOf("(*)"),s.question_sanitized.split(" ").indexOf("[*]"))+1;return 0===n&&(n=s.question_sanitized.split(" ").length/2,n=Math.floor(n)),{buzzpoint:n,correctBuzz:!0}},"Buzz right after the power mark"],"buzz-randomly":[({packetLength:e,oldTossup:t,tossup:s})=>({buzzpoint:Math.floor(Math.random()*s.question_sanitized.split(" ").length),correctBuzz:Math.random()<.5}),"Buzz at a random point in the question (50% chance of being correct)"]};!function(e){for(const[t,[s,n]]of Object.entries(e))document.getElementById("choose-ai").innerHTML+=`\n        <div class="form-check">\n          <input class="form-check-input" type="radio" name="ai-choice" id="ai-choice-${t}">\n          <label class="form-check-label" for="ai-choice-${t}">\n            ${t} - ${n}\n          </label>\n        </div>\n        `;const t=Object.keys(e)[0];document.getElementById(`ai-choice-${t}`).checked=!0}(r);const a=r},685:(e,t,s)=>{s.d(t,{A:()=>n});class n{static deleteUsername(){window.sessionStorage.setItem("account-username",JSON.stringify({username:null,expires:null})),document.getElementById("login-link").textContent="Log in",document.getElementById("login-link").href="/user/login"}static async getUsername(){let e;try{e=window.sessionStorage.getItem("account-username"),e=e?JSON.parse(e):{},e=e||{}}catch(t){e={},window.sessionStorage.setItem("account-username",JSON.stringify(e))}let{username:t,expires:s}=e;if(null===t)return null;if(void 0===t){const e=await fetch("/auth/get-username").then(e=>401===e.status?{username:null,expires:null}:e.json());t=e.username,window.sessionStorage.setItem("account-username",JSON.stringify(e))}else(null===s||s<Date.now())&&(t=null,window.sessionStorage.setItem("account-username",JSON.stringify({username:null,expires:null})));return t}static setUsername(e,t){window.sessionStorage.setItem("account-username",JSON.stringify({username:e,expires:t}))}}},756:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(412);function r(e,t,s,r,a){if(!e||!e.userId||!e.username)return void console.error("Player or player.userId or player.username is undefined",{player:e});if("string"!=typeof e.userId||"string"!=typeof e.username)return void console.error("player.userId and player.username must be strings",{player:e});e.userId=(0,n.Zn)(e.userId),e.username=(0,n.Zn)(e.username);const{userId:i,username:o,powers:c=0,tens:l=0,negs:u=0,tuh:d=0,points:m=0,online:g}=e,h=e?.celerity?.correct?.average??e?.celerity??0,p=s===i;document.getElementById("list-group-"+i)&&document.getElementById("list-group-"+i).remove();const y=document.createElement("a");y.className=`list-group-item clickable ${i===t?"user-score":""} ${!1===g&&"offline"}`,y.id=`list-group-${i}`;const b=p&&!a?`👑 ${o}`:o;y.innerHTML=`\n  <div class="d-flex justify-content-between align-items-center">\n      <div class="d-flex align-items-center">\n          <span id="username-${i}" class="me-1">${b}</span>\n          \x3c!-- Dropdown  --\x3e\n      </div>\n      <span><span id="points-${i}" class="badge rounded-pill ${g?"bg-success":"bg-secondary"}">${m}</span></span>\n  </div>\n`,y.setAttribute("data-bs-container","body"),y.setAttribute("data-bs-custom-class","custom-popover"),y.setAttribute("data-bs-html","true"),y.setAttribute("data-bs-placement","left"),y.setAttribute("data-bs-toggle","popover"),y.setAttribute("data-bs-trigger","focus"),y.setAttribute("tabindex","0"),y.setAttribute("data-bs-title",o),y.setAttribute("data-bs-content",`\n    <ul class="list-group list-group-flush">\n        <li class="list-group-item"><span>Powers</span><span id="powers-${i}" class="float-end badge rounded-pill bg-secondary stats-${i}">${c}</span></li>\n        <li class="list-group-item"><span>Tens</span><span id="tens-${i}" class="float-end badge rounded-pill bg-secondary stats-${i}">${l}</span></li>\n        <li class="list-group-item"><span>Negs</span><span id="negs-${i}" class="float-end badge rounded-pill bg-secondary stats-${i}">${u}</span></li>\n        <li class="list-group-item"><span>TUH</span><span id="tuh-${i}" class="float-end badge rounded-pill bg-secondary stats-${i}">${d}</span></li>\n        <li class="list-group-item"><span>Celerity</span><span id="celerity-${i}" class="float-end stats stats-${i}">${h.toFixed(3)}</span></li>\n        <li class="list-group-item"><span>Is Owner?</span><span id="owner-${i}" class="float-end stats stats-${i}">${p?"Yes":"No"}</span></li>\n    </ul>\n  `),document.getElementById("player-list-group").appendChild(y);const w=s===t&&i!==s&&!a&&"ai-bot"!==i,f="ai-bot"!==i&&i!==t&&!a,E=i!==t&&(a||i!==s&&"ai-bot"!==i);if(w||f||E){const t=document.createElement("div");t.className="ms-1";const s=document.createElement("button");s.className="btn btn-default dropdown-toggle py-0 px-1",s.setAttribute("data-bs-toggle","dropdown"),s.setAttribute("type","button"),t.appendChild(s);const n=document.createElement("ul");if(n.className="dropdown-menu",n.setAttribute("aria-labelledby","playerActionsDropdown"),f){const t=document.createElement("li"),s=document.createElement("button");s.textContent="Mute",s.className="btn btn-warning btn-sm mt-2 me-1 dropdown-item",s.title="Mute/Unmute an user to change visibility of what they say in chat.",t.appendChild(s),n.appendChild(t),s.addEventListener("click",()=>{r.send(JSON.stringify({type:"toggle-mute",targetId:i,targetUsername:e.username,muteStatus:s.textContent})),s.textContent="Unmute"===s.textContent?"Mute":"Unmute"})}if(E){const e=document.createElement("li"),t=document.createElement("button");t.className="btn btn-warning btn-sm mt-2 me-1 dropdown-item",t.title="Initiate a votekick on an user. 90 second cooldown.",t.textContent="Votekick",e.appendChild(t),n.appendChild(e),t.addEventListener("click",()=>{r.send(JSON.stringify({type:"votekick-vote",targetId:i})),r.send(JSON.stringify({type:"votekick-init",targetId:i})),t.disabled=!0,t.textContent="Cooldown",setTimeout(()=>{t.disabled=!1,t.textContent="VK"},9e4)})}if(w){const e=document.createElement("li"),t=document.createElement("button");t.className="btn btn-danger btn-sm mt-2 me-1 dropdown-item",t.title="Ban an user. They can no longer join the room.",t.textContent="Ban",e.appendChild(t),n.appendChild(e),t.addEventListener("click",()=>{r.send(JSON.stringify({type:"ban",targetId:i,targetUsername:o}))})}t.appendChild(n);const a=y.querySelector(`#username-${i}`);a.classList.add("me-2"),a.after(t)}new bootstrap.Popover(y)}},764:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>m});var r=s(837),a=s(496),i=s(756),o=s(528),c=e([o]);o=(c.then?(await c)():c)[0];const l="2025-01-14",u="2025-05-07",d="2024-11-02";class m extends o.A{constructor(e,t,s){super(e,t),this.aiBot=s}onmessage(e){const t=JSON.parse(e);switch(t.type){case"clear-stats":return this.clearStats(t);case"toggle-ai-mode":return this.toggleAiMode(t);case"toggle-correct":return this.toggleCorrect(t);case"toggle-show-history":return this.toggleShowHistory(t);case"toggle-type-to-answer":return this.toggleTypeToAnswer(t);default:return super.onmessage(e)}}buzz({timer:e,userId:t,username:s}){t===this.USER_ID&&(super.buzz({userId:t}),this.room.settings.typeToAnswer?(document.getElementById("answer-input-group").classList.remove("d-none"),document.getElementById("answer-input").focus()):(document.getElementById("buzz").disabled=!1,document.getElementById("buzz").textContent="Reveal"))}clearStats({userId:e}){this.updateStatDisplay(this.room.players[e])}async giveAnswer({directive:e,directedPrompt:t,perQuestionCelerity:s,score:n,tossup:r,userId:a}){super.giveAnswer({directive:e,directedPrompt:t,score:n,userId:a}),"prompt"!==e&&(a===this.USER_ID?this.updateStatDisplay(this.room.players[this.USER_ID]):this.aiBot.active&&(0,i.A)(this.aiBot.player),this.room.settings.rebuzz&&"reject"===e&&(document.getElementById("buzz").disabled=!1,document.getElementById("buzz").textContent="Buzz",document.getElementById("pause").disabled=!1))}async next({packetLength:e,oldTossup:t,tossup:s,type:n}){const i=this.room.mode===r.mT.STARRED||this.room.mode!==r.mT.LOCAL&&null;if(super.next({nextTossup:s,oldTossup:t,packetLength:e,starred:i,type:n}),"start"===n&&(document.getElementById("next").disabled=!1),document.getElementById("toggle-correct").textContent="I was wrong",document.getElementById("toggle-correct").classList.add("d-none"),"end"===n?(document.getElementById("next").disabled=!0,document.getElementById("pause").disabled=!0):document.getElementById("next").textContent="Skip",("end"===n||"next"===n)&&this.room.previous.userId===this.USER_ID&&this.room.mode!==r.mT.LOCAL){const e=this.room.previous.isCorrect?this.room.previous.inPower?this.room.previous.powerValue:10:this.room.previous.endOfQuestion?0:this.room.previous.negValue;a.A.recordTossup({_id:this.room.previous.tossup._id,celerity:this.room.previous.celerity,isCorrect:this.room.previous.isCorrect,multiplayer:!1,pointValue:e})}}revealAnswer({answer:e,question:t}){super.revealAnswer({answer:e,question:t}),document.getElementById("buzz").disabled=!0,document.getElementById("buzz").textContent="Buzz",document.getElementById("next").disabled=!1,document.getElementById("next").textContent="Next",document.getElementById("start").disabled=!1,document.getElementById("toggle-correct").classList.remove("d-none"),document.getElementById("toggle-correct").textContent=this.room.previous.isCorrect?"I was wrong":"I was right"}setCategories({alternateSubcategories:e,categories:t,subcategories:s,percentView:n,categoryPercents:r}){super.setCategories(),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}setDifficulties({difficulties:e}){window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}setStrictness({strictness:e}){super.setStrictness({strictness:e}),window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}setPacketNumbers({packetNumbers:e}){super.setPacketNumbers({packetNumbers:e}),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}setReadingSpeed({readingSpeed:e}){super.setReadingSpeed({readingSpeed:e}),window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}async setSetName({setName:e,setLength:t}){super.setSetName({setName:e,setLength:t}),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}setYearRange({minYear:e,maxYear:t}){super.setYearRange({minYear:e,maxYear:t}),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}toggleAiMode({aiMode:e}){e&&(0,i.A)(this.aiBot.player),this.aiBot.active=e,document.getElementById("ai-settings").disabled=!e,document.getElementById("toggle-ai-mode").checked=e,document.getElementById("player-list-group").classList.toggle("d-none",!e),document.getElementById("player-list-group-hr").classList.toggle("d-none",!e),window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}toggleCorrect({correct:e,userId:t}){this.updateStatDisplay(this.room.players[this.USER_ID]),document.getElementById("toggle-correct").textContent=e?"I was wrong":"I was right"}togglePowermarkOnly({powermarkOnly:e}){super.togglePowermarkOnly({powermarkOnly:e}),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}toggleRebuzz({rebuzz:e}){super.toggleRebuzz({rebuzz:e}),window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}setMode({mode:e}){switch(e){case r.mT.SET_NAME:case r.mT.RANDOM:document.getElementById("local-packet-settings").classList.add("d-none");break;case r.mT.STARRED:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("local-packet-settings").classList.add("d-none"),document.getElementById("set-settings").classList.add("d-none"),document.getElementById("toggle-powermark-only").disabled=!0,document.getElementById("toggle-standard-only").disabled=!0;break;case r.mT.LOCAL:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("local-packet-settings").classList.remove("d-none"),document.getElementById("set-settings").classList.add("d-none"),document.getElementById("toggle-powermark-only").disabled=!0,document.getElementById("toggle-standard-only").disabled=!0}super.setMode({mode:e}),window.localStorage.setItem("singleplayer-tossup-mode",JSON.stringify({mode:e,version:l}))}toggleShowHistory({showHistory:e}){document.getElementById("room-history").classList.toggle("d-none",!e),document.getElementById("toggle-show-history").checked=e,window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}toggleStandardOnly({standardOnly:e}){super.toggleStandardOnly({standardOnly:e}),window.localStorage.setItem("singleplayer-tossup-query",JSON.stringify({...this.room.query,version:u}))}toggleTimer({timer:e}){super.toggleTimer({timer:e}),window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}toggleTypeToAnswer({typeToAnswer:e}){document.getElementById("type-to-answer").checked=e,window.localStorage.setItem("singleplayer-tossup-settings",JSON.stringify({...this.room.settings,version:d}))}updateStatDisplay({powers:e,tens:t,negs:s,tuh:n,points:r,celerity:a}){const i=a.correct.average.toFixed(3),o=1===n?"":"s";document.getElementById("statline").innerHTML=`${e}/${t}/${s} with ${n} tossup${o} seen (${r} pts, celerity: ${i})`,document.getElementById("clear-stats").disabled=0===n}}n()}catch(e){n(e)}})},828:(e,t,s)=>{function n(e){const t=[];return Array.from(document.getElementById(e).children).forEach(e=>{const s=e.querySelector("input");s.checked&&t.push(parseInt(s.value))}),t}s.d(t,{cl:()=>n})},837:(e,t,s)=>{s.d(t,{BK:()=>i,TX:()=>l,d2:()=>a,jG:()=>r,l4:()=>o,mT:()=>c,zN:()=>n});const n=2e3,r=2010,a=2025,i=10,o=5,c=Object.freeze({SET_NAME:"select by set name",RANDOM:"random questions",STARRED:"starred questions",LOCAL:"local packet"}),l=(Object.freeze({NOT_STARTED:0,READING:1,LAST_PART_REVEALED:2}),Object.freeze({NOT_STARTED:0,READING:1,ANSWER_REVEALED:2}))},955:(e,t,s)=>{s.d(t,{A:()=>a});const n=[[0,"Pop Culture"],[1,"Middle School"],[2,"Easy High School"],[3,"Regular High School"],[4,"Hard High School"],[5,"National High School"],[6,"● / Easy College"],[7,"●● / Medium College"],[8,"●●● / Regionals College"],[9,"●●●● / Nationals College"],[10,"Open"]];function r({startChecked:e=!1,label:t,value:s}){const[n,r]=React.useState(e);return React.createElement("li",{className:n?"active":void 0},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:s,onClick:function(e){r(e.target.checked)},defaultChecked:n}),s,": ",t))}const a=function({startingDifficulties:e=[],onChange:t=()=>{}}){return React.createElement("div",{className:"dropdown-checklist btn-group w-100"},React.createElement("button",{className:"btn btn-default text-start w-100",id:"dropdownMenu1","data-bs-toggle":"dropdown",type:"button","aria-expanded":"true","aria-haspopup":"true"},"Difficulties"),React.createElement("button",{className:"btn btn-default dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown",type:"button"}),React.createElement("ul",{className:"dropdown-menu checkbox-menu allow-focus",id:"difficulties","aria-labelledby":"dropdownMenu1",onClick:e=>e.stopPropagation(),onChange:t},n.map(([t,s])=>React.createElement(r,{key:t,label:s,startChecked:e.includes(t),value:t}))))}},994:(e,t,s)=>{function n(e){if(0===e.length)return"";let t="",s=(e=(e=[...new Set(e)]).sort((e,t)=>e-t))[0],n=e[0];for(let r=1;r<e.length;r++)e[r]-n===1||(t=s===n?`${t}, ${s}`:`${t}, ${s}-${n}`,s=e[r]),n=e[r];return t=s===n?`${t}, ${s}`:`${t}, ${s}-${n}`,t.slice(2)}function r(e,t=0){0===e.length&&(e=`1-${t}`),e.endsWith("-")&&(e+=t);const s=e.split(","),n=[];for(let e=0;e<s.length;e++){const t=s[e].trim().split("-");1===t.length?n.push([parseInt(t[0]),parseInt(t[0])]):n.push([parseInt(t[0]),parseInt(t[1])])}const r=[];for(let e=0;e<n.length;e++)for(let t=n[e][0];t<=n[e][1];t++)r.push(t);return r}s.d(t,{A:()=>r,w:()=>n})}},o={};function c(e){var t=o[e];if(void 0!==t)return t.exports;var s=o[e]={exports:{}};return i[e](s,s.exports,c),s.exports}t="function"==typeof Symbol,s=t?Symbol("webpack queues"):"__webpack_queues__",n=t?Symbol("webpack exports"):"__webpack_exports__",r=t?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},c.a=(e,t,i)=>{var o;i&&((o=[]).d=-1);var c,l,u,d=new Set,m=e.exports,g=new Promise((e,t)=>{u=t,l=e});g[n]=m,g[s]=e=>(o&&e(o),d.forEach(e),g.catch(e=>{})),e.exports=g,t(e=>{var t;c=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[s])return e;if(e.then){var t=[];t.d=0,e.then(e=>{i[n]=e,a(t)},e=>{i[r]=e,a(t)});var i={};return i[s]=e=>e(t),i}}var o={};return o[s]=e=>{},o[n]=e,o}))(e);var i=()=>c.map(e=>{if(e[r])throw e[r];return e[n]}),l=new Promise(e=>{(t=()=>e(i)).r=0;var n=e=>e!==o&&!d.has(e)&&(d.add(e),e&&!e.d&&(t.r++,e.push(t)));c.map(e=>e[s](n))});return t.r?l:i()},e=>(e?u(g[r]=e):l(m),a(o))),o&&o.d<0&&(o.d=0)},c.d=(e,t)=>{for(var s in t)c.o(t,s)&&!c.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c(355);