import*as e from"https://cdn.jsdelivr.net/npm/qb-answer-checker@1.1.7/dist/main.mjs";var t,s,n,r,a,o={36:(e,t,s)=>{async function n(){const e=await fetch("/api/set-list");return(await e.json()).setList}s.d(t,{A:()=>n})},118:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>u});var r=s(837),a=s(685),o=s(599),i=s(994),c=s(36);const l=await(0,c.A)();class u{constructor(e,t){this.room=e,this.USER_ID=t,this.SET_LIST=l,document.getElementById("set-list").innerHTML=this.SET_LIST.map(e=>`<option>${e}</option>`).join("")}onmessage(e){const t=JSON.parse(e);switch(t.type){case"alert":return window.alert(t.message);case"end":case"next":case"skip":case"start":return this.next(t);case"end-of-set":return this.endOfSet(t);case"give-answer":return this.giveAnswer(t);case"no-questions-found":return this.noQuestionsFound(t);case"set-categories":return this.setCategories(t);case"set-difficulties":return this.setDifficulties(t);case"set-mode":return this.setMode(t);case"set-packet-numbers":return this.setPacketNumbers(t);case"set-set-name":return this.setSetName(t);case"set-strictness":return this.setStrictness(t);case"set-year-range":return this.setYearRange(t);case"timer-update":return this.timerUpdate(t);case"toggle-standard-only":return this.toggleStandardOnly(t);case"toggle-timer":return this.toggleTimer(t)}}endOfSet(){window.alert("You have reached the end of the set")}giveAnswer({directive:e,directedPrompt:t,score:s,userId:n}){document.getElementById("answer-input").value="",document.getElementById("answer-input").blur(),document.getElementById("answer-input").placeholder="Enter answer",document.getElementById("answer-input-group").classList.add("d-none"),"prompt"===e&&n===this.USER_ID&&(document.getElementById("answer-input-group").classList.remove("d-none"),document.getElementById("answer-input").focus(),document.getElementById("answer-input").placeholder=t?`Prompt: "${t}"`:"Prompt"),o.A.soundEffects&&n===this.USER_ID&&("accept"===e&&s&&s>10?o.A.power.play():"accept"===e?o.A.correct.play():"reject"===e&&o.A.incorrect.play())}next({type:e,nextQuestion:t,packetLength:s}){document.getElementById("question").textContent="",document.getElementById("settings").classList.add("d-none"),"end"!==e&&(document.getElementById("packet-length-info").textContent=this.room.mode===r.mT.SET_NAME?s:"-",document.getElementById("packet-number-info").textContent=t.packet.number,document.getElementById("set-name-info").textContent=t.set.name,document.getElementById("question-number-info").textContent=t.number)}noQuestionsFound(){window.alert("No questions found")}setCategories(){this.room.categoryManager.loadCategoryModal()}setDifficulties(){throw new Error("Not implemented")}setMode({mode:e}){switch(document.getElementById("set-mode").value=e,e){case r.mT.SET_NAME:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("set-settings").classList.remove("d-none");break;case r.mT.RANDOM:document.getElementById("difficulty-settings").classList.remove("d-none"),document.getElementById("set-settings").classList.add("d-none")}}setPacketNumbers({packetNumbers:e}){document.getElementById("packet-number").value=(0,i.w)(e)}setSetName({setName:e,setLength:t}){document.getElementById("set-name").value=e;const s=!e||this.SET_LIST.includes(e);document.getElementById("packet-number").placeholder="Packet Numbers"+(t?` (1-${t})`:""),document.getElementById("set-name").classList.toggle("is-invalid",!s)}setStrictness({strictness:e}){document.getElementById("set-strictness").value=e,document.getElementById("strictness-display").textContent=e}setYearRange({minYear:e,maxYear:t}){$("#slider").slider("values",[e,t]),document.getElementById("year-range-a").textContent=e,document.getElementById("year-range-b").textContent=t}timerUpdate({timeRemaining:e}){const t=Math.floor(e/10),s=e%10;document.querySelector(".timer .face").textContent=t,document.querySelector(".timer .fraction").textContent="."+s}toggleStandardOnly({standardOnly:e}){document.getElementById("toggle-standard-only").checked=e}toggleTimer({timer:e}){document.getElementById("timer").classList.toggle("d-none",!e),document.getElementById("toggle-timer").checked=e}}const d=window.localStorage.getItem("font-size");function m(){if(window.navigator.userAgent.match(/Mobile.*Firefox/)){const e=document.getElementById("set-name");e.addEventListener("input",function(){document.getElementById("set-dropdown")?.remove();const t=this.value.toLowerCase(),s=l.filter(e=>e.toLowerCase().includes(t)).map(e=>`<a class="dropdown-item" onclick="fillSetName(event)">${e}</a>`).join(""),n=""===s?"":`\n        <div id="set-dropdown" class="dropdown-menu" style="display: inline" aria-labelledby="set-name">\n            ${s}\n        </div>\n        `;e.insertAdjacentHTML("afterend",n)}),e.addEventListener("blur",function(){document.getElementById("set-dropdown")?.remove()})}}d&&document.getElementById("question").style.setProperty("font-size",`${d}px`),"true"===window.localStorage.getItem("high-contrast-question-text")&&document.getElementById("question").classList.add("high-contrast-question-text"),m();const g={};a.A.getUsername().then(e=>{const t=new bootstrap.Toast(document.getElementById("funny-toast")),s=document.getElementById("funny-toast-text");e in g&&(s.textContent=g[e],t.show())}),document.querySelectorAll("span.default-min-year").forEach(e=>{e.textContent=r.jG}),document.querySelectorAll("span.default-max-year").forEach(e=>{e.textContent=r.d2});const h=[];document.body.onmouseup=function(){for(let e=0;e<h.length;++e)h[e].onchange&&h[e].onchange();h.length=0},$("#slider").slider({min:r.zN,max:r.d2,step:1,values:[r.jG,r.d2],slide:function(e,t){for(let e=0;e<t.values.length;++e)$(`span.sliderValue${e}`)[0].textContent=t.values[e],h.includes($(`span.sliderValue${e}`)[0])||h.push($(`span.sliderValue${e}`)[0])}}),document.getElementById("slider").classList.remove("ui-widget-content"),document.getElementById("slider").classList.remove("ui-widget"),$("input.sliderValue").change(function(){const e=$(this);$("#slider").slider("values",e.data("index"),e.val())}),n()}catch(y){n(y)}},1)},251:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(685);class r{static starredSvg='<i class="bi bi-star-fill"></i>';static unstarredSvg='<i class="bi bi-star"></i>';static async starBonus(e){return fetch("/auth/stars/star-bonus",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({bonus_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error starring the bonus."),e.ok)).catch(e=>(window.alert("There was an error starring the bonus."),!1))}static async starTossup(e){return fetch("/auth/stars/star-tossup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tossup_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error starring the bonus."),e.ok)).catch(e=>(window.alert("There was an error starring the bonus."),!1))}static async unstarBonus(e){return fetch("/auth/stars/unstar-bonus",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({bonus_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error unstarring the bonus."),e.ok)).catch(e=>(window.alert("There was an error unstarring the bonus."),!1))}static async unstarTossup(e){return fetch("/auth/stars/unstar-tossup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tossup_id:e})}).then(e=>(401===e.status?new bootstrap.Toast(document.getElementById("star-toast")).show():e.ok||window.alert("There was an error unstarring the bonus."),e.ok)).catch(e=>(window.alert("There was an error unstarring the bonus."),!1))}static async isStarredBonus(e){return!!await n.A.getUsername()&&await fetch(`/auth/stars/is-starred-bonus?bonus_id=${e}`).then(e=>e.json()).then(e=>e.isStarred).catch(e=>!1)}static async isStarredTossup(e){return!!await n.A.getUsername()&&await fetch(`/auth/stars/is-starred-tossup?tossup_id=${e}`).then(e=>e.json()).then(e=>e.isStarred).catch(e=>!1)}static async getStarredTossups(){return await fetch("/auth/stars/tossups").then(e=>e.json()).then(e=>e)}static async getStarredBonuses(){return await fetch("/auth/stars/bonuses").then(e=>e.json()).then(e=>e)}static async getStarredTossupIds(){return await n.A.getUsername()?await fetch("/auth/stars/tossup-ids").then(e=>e.json()).then(e=>e):[]}static async getStarredBonusIds(){return await n.A.getUsername()?await fetch("/auth/stars/bonus-ids").then(e=>e.json()).then(e=>e):[]}static async clearStarredTossups(){const e=await fetch("/auth/stars/clear-tossup-stars",{method:"DELETE",headers:{"Content-Type":"application/json"}});e.ok||window.alert("There was an error clearing starred tossups.");const{count:t}=await e.json();t&&window.alert(`Cleared ${t} starred tossups.`)}static async clearStarredBonuses(){const e=await fetch("/auth/stars/clear-bonus-stars",{method:"DELETE",headers:{"Content-Type":"application/json"}});e.ok||window.alert("There was an error clearing starred bonuses.");const{count:t}=await e.json();t&&window.alert(`Cleared ${t} starred bonuses.`)}}function a(e){return e.replace(/\[[^\]]*\]/g,"").replace(/\([^)]*\)/g,"").trim()}function o(e,t,s=10,n=""){return`[${e?.values?.[t]??s}${e?.difficultyModifiers?.[t]??n}]`}async function i({bonus:e,starred:t}){if(!e||0===Object.keys(e).length)return;const{leadin:s,parts:n,answers:i,category:c,subcategory:l,alternate_subcategory:u,set:d,packet:m,number:g,_id:h}=e,y=e.parts.length;let p="";for(let t=0;t<y;t++)p+=`<hr></hr>\n      <p>\n        ${o(e,t)} ${n[t]}\n        ${t+1===y?`<a class="user-select-none" href="#" id="report-question-${h}" data-bs-toggle="modal" data-bs-target="#report-question-modal">Report Question</a>`:""}\n      </p>\n      <div>ANSWER: ${i[t]}</div>\n    `;t=t??await r.isStarredBonus(h);const b=document.createElement("div");b.className="card my-2",b.innerHTML=`\n    <div class="card-header d-flex justify-content-between">\n      <span class="card-header-clickable clickable" data-bs-toggle="collapse" data-bs-target="#question-${h}" aria-expanded="true">\n        ${i.map(a).join(" / ")}\n      </span>\n      <a href="#" class="star-bonus ${t?"selected":""}" id="star-bonus-${h}">\n        ${t?r.starredSvg:r.unstarredSvg}\n      </a>\n    </div>\n    <div class="card-container collapse" id="question-${h}">\n      <div class="card-body">\n        <p>${s}</p>\n        ${p}\n      </div>\n      <div class="card-footer">\n        <small class="text-muted">${d.name} / ${c} / ${l}${u?" / "+u:""}</small>\n        <small class="text-muted float-end">Packet ${m.number} / Question ${g}</small>\n      </div>\n    </div>\n  `,document.getElementById("room-history").prepend(b),document.getElementById("report-question-"+h).addEventListener("click",()=>{document.getElementById("report-question-id").value=h}),document.getElementById("star-bonus-"+h).addEventListener("click",async function(e){e.preventDefault(),e.stopPropagation(),this.classList.contains("selected")?(this.innerHTML=r.unstarredSvg,r.unstarBonus(h),this.classList.remove("selected")):await r.starBonus(h)&&(this.innerHTML=r.starredSvg,this.classList.add("selected"))})}},257:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>d});var r=s(837),a=s(496),o=s(901),i=e([o]);o=(i.then?(await i)():i)[0];const c="2025-01-14",l="2025-05-07",u="2024-11-02";class d extends o.A{onmessage(e){const t=JSON.parse(e);switch(t.type){case"clear-stats":return this.clearStats(t);case"reveal-leadin":return this.revealLeadin(t);case"reveal-next-answer":return this.revealNextAnswer(t);case"reveal-next-part":return this.revealNextPart(t);case"start-answer":return this.startAnswer(t);case"toggle-correct":return this.toggleCorrect(t);case"toggle-show-history":return this.toggleShowHistory(t);case"toggle-three-part-bonuses":return this.toggleThreePartBonuses(t);case"toggle-type-to-answer":return this.toggleTypeToAnswer(t);default:return super.onmessage(e)}}clearStats({teamId:e}){this.updateStatDisplay({0:0,10:0,20:0,30:0})}async giveAnswer({currentPartNumber:e,directive:t,directedPrompt:s,userId:n}){super.giveAnswer({currentPartNumber:e,directive:t,directedPrompt:s,userId:n})}async next({type:e,bonus:t,lastPartRevealed:s,oldBonus:n,packetLength:o,pointsPerPart:i,stats:c,teamId:l}){const u=this.room.mode===r.mT.STARRED||this.room.mode!==r.mT.LOCAL&&null;super.next({bonus:t,oldBonus:n,packetLength:o,starred:u,type:e}),"start"===e&&(document.getElementById("next").disabled=!1),s&&this.room.mode!==r.mT.LOCAL&&(a.A.recordBonus({_id:n._id,pointsPerPart:i}),this.updateStatDisplay(c))}revealNextAnswer({answer:e,currentPartNumber:t,lastPartRevealed:s}){const n=document.createElement("p");n.innerHTML="ANSWER: "+e,document.getElementById(`bonus-part-${t+1}`).appendChild(n),s&&(document.getElementById("reveal").disabled=!0,document.getElementById("next").textContent="Next")}revealLeadin({leadin:e}){const t=document.createElement("p");t.id="leadin",t.innerHTML=e,document.getElementById("question").appendChild(t)}revealNextPart({currentPartNumber:e,part:t,value:s}){const n=document.createElement("input");n.id=`checkbox-${e+1}`,n.className="checkbox form-check-input rounded-0 me-1",n.type="checkbox",n.style="width: 20px; height: 20px; cursor: pointer";const r=this.room,a=this.USER_ID;n.addEventListener("click",function(){r.message(a,{type:"toggle-correct",partNumber:e,correct:this.checked})});const o=document.createElement("label");o.style="cursor: pointer",o.appendChild(n);const i=document.createElement("p");i.innerHTML=`[${s}] ${t}`;const c=document.createElement("div");c.id=`bonus-part-${e+1}`,c.appendChild(i);const l=document.createElement("div");l.className="d-flex",l.appendChild(o),l.appendChild(c),document.getElementById("question").appendChild(l)}setCategories({alternateSubcategories:e,categories:t,subcategories:s,percentView:n,categoryPercents:r}){super.setCategories(),window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}setDifficulties({difficulties:e}){window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}setPacketNumbers({packetNumbers:e}){super.setPacketNumbers({packetNumbers:e}),window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}async setSetName({setName:e,setLength:t}){super.setSetName({setName:e,setLength:t}),window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}setStrictness({strictness:e}){super.setStrictness({strictness:e}),window.localStorage.setItem("singleplayer-bonus-settings",JSON.stringify({...this.room.settings,version:u}))}setYearRange({minYear:e,maxYear:t}){super.setYearRange({minYear:e,maxYear:t}),window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}startAnswer(){document.getElementById("answer-input-group").classList.remove("d-none"),document.getElementById("answer-input").focus(),document.getElementById("reveal").disabled=!0}toggleCorrect({partNumber:e,correct:t}){document.getElementById(`checkbox-${e+1}`).checked=t}setMode({mode:e}){switch(e){case r.mT.SET_NAME:case r.mT.RANDOM:document.getElementById("local-packet-settings").classList.add("d-none");break;case r.mT.STARRED:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("local-packet-settings").classList.add("d-none"),document.getElementById("set-settings").classList.add("d-none"),document.getElementById("toggle-standard-only").disabled=!0,document.getElementById("toggle-three-part-bonuses").disabled=!0;break;case r.mT.LOCAL:document.getElementById("difficulty-settings").classList.add("d-none"),document.getElementById("local-packet-settings").classList.remove("d-none"),document.getElementById("set-settings").classList.add("d-none"),document.getElementById("toggle-standard-only").disabled=!0,document.getElementById("toggle-three-part-bonuses").disabled=!0}super.setMode({mode:e}),window.localStorage.setItem("singleplayer-bonus-mode",JSON.stringify({mode:e,version:c}))}toggleShowHistory({showHistory:e}){document.getElementById("room-history").classList.toggle("d-none",!e),document.getElementById("toggle-show-history").checked=e,window.localStorage.setItem("singleplayer-bonus-settings",JSON.stringify({...this.room.settings,version:u}))}toggleStandardOnly({standardOnly:e}){super.toggleStandardOnly({standardOnly:e}),window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}toggleThreePartBonuses({threePartBonuses:e}){document.getElementById("toggle-three-part-bonuses").checked=e,window.localStorage.setItem("singleplayer-bonus-query",JSON.stringify({...this.room.query,version:l}))}toggleTimer({timer:e}){super.toggleTimer({timer:e}),window.localStorage.setItem("singleplayer-bonus-settings",JSON.stringify({...this.room.settings,version:u}))}toggleTypeToAnswer({typeToAnswer:e}){document.getElementById("type-to-answer").checked=e,window.localStorage.setItem("singleplayer-bonus-settings",JSON.stringify({...this.room.settings,version:u}))}updateStatDisplay(e){const t=e[0]+e[10]+e[20]+e[30],s=30*e[30]+20*e[20]+10*e[10],n=Math.round(100*s/t)/100||0,r=1===t?"":"es";document.getElementById("statline").textContent=`${n} PPB with ${t} bonus${r} seen (${e[30]}/${e[20]}/${e[10]}/${e[0]}, ${s} pts)`}}n()}catch(e){n(e)}})},267:(e,t,s)=>{s.d(t,{A:()=>o});const n=[["Literature","primary"],["History","success"],["Science","danger"],["Fine Arts","warning"],["Religion","secondary"],["Mythology","secondary"],["Philosophy","secondary"],["Social Science","secondary"],["Current Events","secondary"],["Geography","secondary"],["Other Academic","secondary"],["Pop Culture","secondary"]],r=[["American Literature","primary"],["British Literature","primary"],["Classical Literature","primary"],["European Literature","primary"],["World Literature","primary"],["Other Literature","primary"],["American History","success"],["Ancient History","success"],["European History","success"],["World History","success"],["Other History","success"],["Biology","danger"],["Chemistry","danger"],["Physics","danger"],["Other Science","danger"],["Visual Fine Arts","warning"],["Auditory Fine Arts","warning"],["Other Fine Arts","warning"],["Movies","secondary"],["Music","secondary"],["Sports","secondary"],["Television","secondary"],["Video Games","secondary"],["Other Pop Culture","secondary"]],a=[["Drama","primary"],["Long Fiction","primary"],["Poetry","primary"],["Short Fiction","primary"],["Misc Literature","primary"],["Math","danger"],["Astronomy","danger"],["Computer Science","danger"],["Earth Science","danger"],["Engineering","danger"],["Misc Science","danger"],["Architecture","warning"],["Dance","warning"],["Film","warning"],["Jazz","warning"],["Musicals","warning"],["Opera","warning"],["Photography","warning"],["Misc Arts","warning"],["Anthropology","secondary"],["Economics","secondary"],["Linguistics","secondary"],["Psychology","secondary"],["Sociology","secondary"],["Other Social Science","secondary"]],o=function({categoryManager:e,disablePercentView:t=!1,onClose:s=()=>{}}){function o({category:t,index:s}){function n(t){const n=Math.min(100,Math.max(0,e.categoryPercents[s]+t));e.categoryPercents[s]=n,e.loadCategoryModal()}return React.createElement("tr",null,React.createElement("th",{style:{width:"50%"}},t),React.createElement("td",{style:{width:"50%"}},React.createElement("span",{className:"font-monospace me-1 category-percent"}),React.createElement("div",{className:"btn-group btn-group-sm me-1",role:"group"},React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(-5)},"-"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(5)},"+")),React.createElement("div",{className:"btn-group btn-group-sm",role:"group"},React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(-100)},"Min"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(50-e.categoryPercents[s])},"50%"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>n(100-e.categoryPercents.reduce((e,t)=>e+t))},"Max"))))}function i({category:t,color:s}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateCategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1`,htmlFor:t},t,React.createElement("br",null)))}function c({subcategory:t,color:s,hidden:n=!1}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateSubcategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1 ${n&&"d-none"}`,htmlFor:t},t,React.createElement("br",null)))}function l({subcategory:t,color:s,hidden:n=!1}){return React.createElement("div",null,React.createElement("input",{type:"checkbox",className:"btn-check",autoComplete:"off",id:t,onClick:function(){e.updateAlternateSubcategory(t),e.loadCategoryModal()}}),React.createElement("label",{className:`btn btn-outline-${s} w-100 rounded-0 my-1 ${n&&"d-none"}`,htmlFor:t},t,React.createElement("br",null)))}return React.useEffect(()=>{e.loadCategoryModal(),document.getElementById("category-modal").addEventListener("hidden.bs.modal",s)},[s]),React.createElement("div",{className:"modal modal-lg",id:"category-modal",tabIndex:"-1"},React.createElement("div",{className:"modal-dialog modal-dialog-scrollable"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h5",{className:"modal-title me-2"},"Select Categories"),React.createElement(function(){return React.createElement("button",{className:"btn btn-primary me-1",id:"toggle-all",onClick:function(){0===e.categories.length?e.import({categories:n.map(e=>e[0]),subcategories:r.map(e=>e[0]),alternateSubcategories:a.map(e=>e[0])}):e.import(),e.loadCategoryModal()}},"Toggle all")},null),t||React.createElement(function(){return React.createElement("button",{className:"btn btn-primary",onClick:function(){e.percentView=!e.percentView,e.loadCategoryModal()}},"% view")},null),React.createElement("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"row",id:"non-percent-view"},React.createElement("div",{className:"col-4",id:"categories"},React.createElement("h5",{className:"text-center"},"Category"),n.map(e=>React.createElement(i,{key:e[0],category:e[0],color:e[1]}))),React.createElement("div",{className:"col-4",id:"subcategories"},React.createElement("h5",{className:"text-center"},"Subcategory"),React.createElement("div",{className:"text-muted text-center",id:"subcategory-info-text"},"You must select categories before you can select subcategories."),r.map(e=>React.createElement(c,{key:e[0],subcategory:e[0],color:e[1],hidden:!0}))),React.createElement("div",{className:"col-4",id:"alternate-subcategories"},React.createElement("h5",{className:"text-center"},"Alternate ",React.createElement("span",{className:"d-none d-lg-inline"},"Subcategory")),a.map(e=>React.createElement(l,{key:e[0],subcategory:e[0],color:e[1],hidden:!0})))),React.createElement("div",{className:"d-none",id:"percent-view"},React.createElement("table",{className:"table"},React.createElement("tbody",null,n.map((e,t)=>React.createElement(o,{key:e[0],category:e[0],index:t})),React.createElement("tr",null,React.createElement("th",null,"Total Percent:"),React.createElement("td",{className:"font-monospace"},React.createElement("span",{className:"me-1"},(e.categoryPercents.reduce((e,t)=>e+t,0)+"").padStart(3," "),"%"),React.createElement("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>{e.categoryPercents=e.categoryPercents.map(()=>0),e.loadCategoryModal()}},"Reset"))))))))))}},283:(e,t,s)=>{function n(e,t,s){document.getElementById("report-question-submit").disabled=!0,fetch("/api/report-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,reason:t,description:s})}).then(e=>{200===e.status?(document.getElementById("report-question-reason").value="wrong-category",document.getElementById("report-question-description").value="",window.alert("Question has been reported.")):window.alert("There was an error reporting the question.")}).catch(e=>{window.alert("There was an error reporting the question.")}).finally(()=>{document.getElementById("report-question-close").click(),document.getElementById("report-question-submit").disabled=!1})}s.d(t,{A:()=>n})},287:(e,t,s)=>{s.d(t,{A:()=>n});const n=class{constructor(e,t=void 0){this.userId=e,this.MAX_USERNAME_LENGTH=t,this.teamId=void 0,this.username="",this.powers=0,this.tens=0,this.zeroes=0,this.negs=0,this.points=0,this.tuh=0,this.celerity={all:{total:0,average:0},correct:{total:0,average:0}}}clearStats(){this.powers=0,this.tens=0,this.zeroes=0,this.negs=0,this.points=0,this.tuh=0,this.celerity={all:{total:0,average:0},correct:{total:0,average:0}}}updateStats(e,t){this.points+=e,this.celerity.all.total+=t,this.celerity.all.average=this.celerity.all.total/this.tuh,e>10?this.powers++:10===e?this.tens++:0===e?this.zeroes++:e<0&&this.negs++,e>0&&(this.celerity.correct.total+=t,this.celerity.correct.average=this.celerity.correct.total/(this.powers+this.tens))}safelySetUsername(e){return e||(e=""),e=e.substring(0,this.MAX_USERNAME_LENGTH),this.username=e,this.username}}},439:(t,s,n)=>{n.d(s,{A:()=>N});var r=n(837);const a={Literature:["American Literature","British Literature","Classical Literature","European Literature","World Literature","Other Literature"],History:["American History","Ancient History","European History","World History","Other History"],Science:["Biology","Chemistry","Physics","Other Science"],"Fine Arts":["Visual Fine Arts","Auditory Fine Arts","Other Fine Arts"],Religion:["Religion"],Mythology:["Mythology"],Philosophy:["Philosophy"],"Social Science":["Social Science"],"Current Events":["Current Events"],Geography:["Geography"],"Other Academic":["Other Academic"],"Pop Culture":["Movies","Music","Sports","Television","Video Games","Other Pop Culture"]},o=Object.keys(a),i={Literature:["Drama","Long Fiction","Poetry","Short Fiction","Misc Literature"],History:[],Science:["Math","Astronomy","Computer Science","Earth Science","Engineering","Misc Science"],"Fine Arts":["Architecture","Dance","Film","Jazz","Musicals","Opera","Photography","Misc Arts"],Religion:[],Mythology:[],Philosophy:[],"Social Science":["Anthropology","Economics","Linguistics","Psychology","Sociology","Other Social Science"],"Current Events":[],Geography:[],"Other Academic":[],"Pop Culture":[]},c={"American Literature":"Literature","British Literature":"Literature","Classical Literature":"Literature","European Literature":"Literature","World Literature":"Literature","Other Literature":"Literature","American History":"History","Ancient History":"History","European History":"History","World History":"History","Other History":"History",Biology:"Science",Chemistry:"Science",Physics:"Science","Other Science":"Science","Visual Fine Arts":"Fine Arts","Auditory Fine Arts":"Fine Arts","Other Fine Arts":"Fine Arts",Religion:"Religion",Mythology:"Mythology",Philosophy:"Philosophy","Social Science":"Social Science","Current Events":"Current Events",Geography:"Geography","Other Academic":"Other Academic",Movies:"Pop Culture",Music:"Pop Culture",Sports:"Pop Culture",Television:"Pop Culture","Video Games":"Pop Culture","Other Pop Culture":"Pop Culture"},l=Object.keys(c),u={Drama:"Literature","Long Fiction":"Literature",Poetry:"Literature","Short Fiction":"Literature","Misc Literature":"Literature",Math:"Science",Astronomy:"Science","Computer Science":"Science","Earth Science":"Science",Engineering:"Science","Misc Science":"Science",Architecture:"Fine Arts",Dance:"Fine Arts",Film:"Fine Arts",Jazz:"Fine Arts",Musicals:"Fine Arts",Opera:"Fine Arts",Photography:"Fine Arts","Misc Arts":"Fine Arts",Anthropology:"Social Science",Economics:"Social Science",Linguistics:"Social Science",Psychology:"Social Science",Sociology:"Social Science","Other Social Science":"Social Science"},d=Object.keys(u);class m{constructor(e=[],t=[],s=[]){this.import({categories:e,subcategories:t,alternateSubcategories:s})}export(){return{categories:this.categories,subcategories:this.subcategories,alternateSubcategories:this.alternateSubcategories,percentView:this.percentView,categoryPercents:this.categoryPercents}}import({categories:e=[],subcategories:t=[],alternateSubcategories:s=[],percentView:n=!1,categoryPercents:r}={}){if(!r){r=[];for(let e=0;e<o.length;e++)r.push(0)}e.length>0&&0===t.length&&e.forEach(e=>{a[e].forEach(e=>{t.push(e)})}),this.categories=e,this.subcategories=t,this.alternateSubcategories=s,this.percentView=n,this.categoryPercents=r}getRandomCategory(){const e=this.categoryPercents.reduce((e,t)=>e+t,0);if(0===e)return o[Math.floor(Math.random()*o.length)];let t=Math.random()*e;for(let e=0;e<this.categoryPercents.length;e++)if(t-=this.categoryPercents[e],t<=0)return o[e]}isValidCategory(e){if(0===this.categories.length&&0===this.subcategories.length)return!0;const t=!e.alternate_subcategory||this.alternateSubcategories.length>0&&this.alternateSubcategories.includes(e.alternate_subcategory);return this.categories.includes(e.category)&&this.subcategories.includes(e.subcategory)&&t}loadCategoryModal(){document.querySelectorAll("#categories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#subcategories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#subcategories label").forEach(e=>{e.classList.add("d-none")}),document.querySelectorAll("#alternate-subcategories input").forEach(e=>{e.checked=!1}),document.querySelectorAll("#alternate-subcategories label").forEach(e=>{e.classList.add("d-none")}),document.getElementById("subcategory-info-text").classList.toggle("d-none",this.categories.length||this.subcategories.length);for(const e of this.categories){document.getElementById(e).checked=!0;for(const t of a[e])document.querySelector(`[for="${t}"]`).classList.remove("d-none");for(const t of i[e])document.querySelector(`[for="${t}"]`).classList.remove("d-none")}for(const e of this.subcategories)document.getElementById(e).checked=!0;for(const e of this.alternateSubcategories)document.getElementById(e).checked=!0;document.getElementById("non-percent-view").className=this.percentView?"d-none":"row",document.getElementById("percent-view").className=this.percentView?"":"d-none",document.getElementById("toggle-all").disabled=this.percentView;const e=document.querySelectorAll(".category-percent");for(let t=0;t<this.categoryPercents.length;t++)e.item(t).textContent=String(this.categoryPercents[t]).padStart(3," ")+"%"}updateCategory(e){return this.categories.includes(e)?(this.categories=this.categories.filter(t=>t!==e),this.subcategories=this.subcategories.filter(t=>!a[e].includes(t)),this.alternateSubcategories=this.alternateSubcategories.filter(t=>!i[e].includes(t)),!1):(this.categories.push(e),this.subcategories=this.subcategories.concat(a[e]),this.alternateSubcategories=this.alternateSubcategories.concat(i[e]),!0)}updateSubcategory(e){return this.subcategories.includes(e)?(this.subcategories=this.subcategories.filter(t=>t!==e),!1):(this.subcategories.push(e),!0)}updateAlternateSubcategory(e){return this.alternateSubcategories.includes(e)?(this.alternateSubcategories=this.alternateSubcategories.filter(t=>t!==e),!1):(this.alternateSubcategories.push(e),!0)}}class g{constructor(e){this.name=e,this.players={},this.sockets={},this.teams={},this.timer={interval:null,timeRemaining:0}}async message(e,t){throw new Error("Not implemented")}emitMessage(e){e=JSON.stringify(e);for(const t of Object.values(this.sockets))t.send(e)}leave(e){this.players[e].online=!1,delete this.sockets[e];const t=this.players[e].username;this.emitMessage({type:"leave",userId:e,username:t})}sendToSocket(e,t){t=JSON.stringify(t),this.sockets[e].send(t)}setUsername(e,{username:t}){if("string"!=typeof t)return!1;const s=this.players[e].username;this.players[e].username=t,this.emitMessage({type:"set-username",userId:e,oldUsername:s,newUsername:t})}startServerTimer(e,t,s){clearInterval(this.timer.interval),this.timer.timeRemaining=e,this.timer.interval=setInterval(()=>{this.timer.timeRemaining<=0&&(clearInterval(this.timer.interval),s()),t(this.timer.timeRemaining),this.timer.timeRemaining--},100)}}class h extends g{constructor(e,t=[],s=[],n=[]){super(e),this.checkAnswer=function(e,t,s=7){throw new Error("Not implemented")},this.getRandomQuestions=async function(e){throw new Error("Not implemented")},this.getSet=async function(e){throw new Error("Not implemented")},this.getNumPackets=async function(e){throw new Error("Not implemented")},this.getRandomStarredQuestion=async function(){throw new Error("Not implemented")},this.getNextLocalQuestion=function(){throw new Error("Not implemented")},this.categoryManager=new m(t,s,n),this.packetLength=void 0,this.queryingQuestion=!1,this.randomQuestionCache=[],this.setCache=[],this.setLength=24,this.mode=r.mT.RANDOM,this.localQuestions={tossups:[],bonuses:[]},this.query={difficulties:[4,5],minYear:r.jG,maxYear:r.d2,packetNumbers:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],setName:"2023 PACE NSC",alternateSubcategories:n,categories:t,subcategories:s,percentView:!1,categoryPercents:o.map(()=>0),reverse:!0,standardOnly:!1},this.settings={randomizeOrder:!1,strictness:7,skip:!1,timer:!0}}message(e,t){switch(t.type){case"set-categories":return this.setCategories(e,t);case"set-difficulties":return this.setDifficulties(e,t);case"set-mode":return this.setMode(e,t);case"set-packet-numbers":return this.setPacketNumbers(e,t);case"set-set-name":return this.setSetName(e,t);case"set-strictness":return this.setStrictness(e,t);case"set-username":return this.setUsername(e,t);case"set-year-range":return this.setYearRange(e,t);case"toggle-randomize-order":return this.toggleRandomizeOrder(e,t);case"toggle-skip":return this.toggleSkip(e,t);case"toggle-standard-only":return this.toggleStandardOnly(e,t);case"toggle-timer":return this.toggleTimer(e,t);case"upload-local-packet":return this.uploadLocalPacket(e,t)}}async adjustQuery(e,t,s=!1){if(e.length===t.length){for(let s=0;s<e.length;s++){const n=e[s],r=t[s];Object.prototype.hasOwnProperty.call(this.query,n)&&(this.query[n]=r)}if(!s)switch(this.mode){case r.mT.SET_NAME:this.setCache=await this.getSet({setName:this.query.setName,packetNumbers:[this.query.packetNumbers[0]]}),this.packetLength=this.setCache.length;break;case r.mT.RANDOM:this.categoryManager.percentView?this.randomQuestionCache=[]:this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:1})}}}async advanceQuestion(){this.queryingQuestion=!0;let e=null;switch(this.mode){case r.mT.SET_NAME:do{if(0===this.setCache.length){this.query.packetNumbers.shift();const e=this.query.packetNumbers[0];if(void 0===e)return this.emitMessage({type:"end-of-set"}),null;this.setCache=await this.getSet({setName:this.query.setName,packetNumbers:[e]}),this.packetLength=this.setCache.length}if(e=this.setCache.shift(),!e?.packet?.number)return this.emitMessage({type:"no-questions-found"}),null;this.query.packetNumbers=this.query.packetNumbers.filter(t=>t>=e.packet.number)}while(!this.categoryManager.isValidCategory(e));break;case r.mT.RANDOM:if(this.categoryManager.percentView){const e=this.categoryManager.getRandomCategory();this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:1,categories:[e],subcategories:[],alternateSubcategories:[]})}else 0===this.randomQuestionCache.length&&(this.randomQuestionCache=await this.getRandomQuestions({...this.query,number:20}));if(0===this.randomQuestionCache?.length)return this.emitMessage({type:"no-questions-found"}),null;e=this.randomQuestionCache.pop();break;case r.mT.STARRED:do{if(e=await this.getRandomStarredQuestion(),null===e)return this.emitMessage({type:"no-questions-found"}),null}while(!this.categoryManager.isValidCategory(e));break;case r.mT.LOCAL:do{if(e=this.getNextLocalQuestion(),null===e)return this.emitMessage({type:"no-questions-found"}),null}while(!this.categoryManager.isValidCategory(e))}return e}setDifficulties(e,{difficulties:t}){if(t.some(e=>"number"!=typeof e||isNaN(e)||e<0||e>10))return!1;const s=this.players[e].username;this.adjustQuery(["difficulties"],[t]),this.emitMessage({type:"set-difficulties",username:s,difficulties:t})}setMode(e,{mode:t,setName:s}){if(!Object.values(r.mT).includes(t))return;this.mode=t;const n=this.players[e].username;this.emitMessage({type:"set-mode",mode:t,setName:s,username:n})}async setPacketNumbers(e,{doNotFetch:t=!1,packetNumbers:s}){if(!Array.isArray(s))return!1;if(s.some(e=>"number"!=typeof e||e<1||e>this.setLength))return!1;const n=this.players[e].username;this.adjustQuery(["packetNumbers"],[s],t),this.emitMessage({type:"set-packet-numbers",username:n,packetNumbers:s})}async setSetName(e,{doNotFetch:t=!1,setName:s}){if("string"!=typeof s)return;const n=this.players[e].username;this.setLength=await this.getNumPackets(s);const r=[];for(let e=1;e<=this.setLength;e++)r.push(e);this.adjustQuery(["setName","packetNumbers"],[s,r],t),this.emitMessage({type:"set-set-name",username:n,setName:s,setLength:this.setLength})}setStrictness(e,{strictness:t}){this.settings.strictness=t;const s=this.players[e].username;this.emitMessage({type:"set-strictness",username:s,strictness:t})}startServerTimer(e,t,s){this.settings.timer&&super.startServerTimer(e,t,s)}toggleRandomizeOrder(e,{randomizeOrder:t}){this.settings.randomizeOrder=t;const s=this.players[e].username;this.emitMessage({type:"toggle-randomize-order",randomizeOrder:t,username:s})}toggleSkip(e,{skip:t}){this.settings.skip=t;const s=this.players[e].username;this.emitMessage({type:"toggle-skip",skip:t,username:s})}toggleStandardOnly(e,{doNotFetch:t=!1,standardOnly:s}){this.query.standardOnly=s;const n=this.players[e].username;this.adjustQuery(["standardOnly"],[s],t),this.emitMessage({type:"toggle-standard-only",standardOnly:s,username:n})}toggleTimer(e,{timer:t}){this.settings.timer=t;const s=this.players[e].username;this.emitMessage({type:"toggle-timer",timer:t,username:s})}setCategories(e,{categories:t,subcategories:s,alternateSubcategories:n,percentView:r,categoryPercents:a}){if(!Array.isArray(t))return;if(!Array.isArray(s))return;if(!Array.isArray(n))return;if(a?.length!==o.length)return;if(t=t.filter(e=>o.includes(e)),s=s.filter(e=>l.includes(e)),n=n.filter(e=>d.includes(e)),s.some(e=>!t.includes(c[e])))return;if(n.some(e=>!t.includes(u[e])))return;this.categoryManager.import({categories:t,subcategories:s,alternateSubcategories:n,percentView:r,categoryPercents:a});const i=this.players[e].username;this.adjustQuery(["categories","subcategories","alternateSubcategories","percentView","categoryPercents"],[t,s,n,r,a]),this.emitMessage({type:"set-categories",...this.categoryManager.export(),username:i})}setYearRange(e,{minYear:t,maxYear:s}){if(t=parseInt(t),s=parseInt(s),isNaN(t)&&(t=r.jG),isNaN(s)&&(s=r.d2),s<t)this.sendToSocket(e,{type:"set-year-range",minYear:this.query.minYear,maxYear:this.query.maxYear,username:null});else{const n=this.players[e].username;this.adjustQuery(["minYear","maxYear"],[t,s]),this.emitMessage({type:"set-year-range",minYear:t,maxYear:s,username:n})}}uploadLocalPacket(e,{packet:t,filename:s}){if("string"==typeof s&&0!==s.length&&"object"==typeof t&&null!==t&&Object.prototype.hasOwnProperty.call(t,"bonuses")&&Object.prototype.hasOwnProperty.call(t,"tossups")){this.localQuestions.tossups=[],this.localQuestions.bonuses=[];for(const e of["bonuses","tossups"]){const n=t[e];if(!Array.isArray(n))return;const r=s.match(/\d+/),a=parseInt(r?.[0]),o=isNaN(a)?1:a;for(let e=0;e<n.length;e++){const t=n[e];t._id=Math.random().toString(16).slice(2),t.number=e+1,t.packet={number:o},t.set={name:s}}this.localQuestions[e]=n}this.emitMessage({type:"alert",message:`Successfully uploaded ${this.localQuestions.tossups.length} tossups and ${this.localQuestions.bonuses.length} bonuses.`,userId:e})}}}class y extends h{constructor(e,t=[],s=[],n=[]){super(e,t,s,n),this.getNextLocalQuestion=()=>{if(0===this.localQuestions.bonuses.length)return null;if(this.settings.randomizeOrder){const e=Math.floor(Math.random()*this.localQuestions.bonuses.length);return this.localQuestions.bonuses.splice(e,1)[0]}return this.localQuestions.bonuses.shift()},this.bonus={},this.bonusProgress=r.s.NOT_STARTED,this.currentPartNumber=-1,this.pointsPerPart=[],this.query={threePartBonuses:!0,...this.query}}async message(e,t){switch(t.type){case"clear-stats":return this.clearStats(e,t);case"end":case"next":case"skip":case"start":return this.next(e,t);case"give-answer":return this.giveAnswer(e,t);case"start-answer":return this.startAnswer(e,t);case"toggle-correct":return this.toggleCorrect(e,t);case"toggle-three-part-bonuses":return this.toggleThreePartBonuses(e,t);default:return super.message(e,t)}}clearStats(e){const t=this.players[e].teamId;this.teams[t].clearStats(),this.emitMessage({type:"clear-stats",userId:e})}getPartValue(e=this.currentPartNumber){return this.bonus?.values?.[this.currentPartNumber]??10}giveAnswer(e,{givenAnswer:t}){if("string"!=typeof t)return!1;this.liveAnswer="",clearInterval(this.timer.interval),this.emitMessage({type:"timer-update",timeRemaining:10*r.BK});const{directive:s,directedPrompt:n}=this.checkAnswer(this.bonus.answers[this.currentPartNumber],t);this.emitMessage({type:"give-answer",currentPartNumber:this.currentPartNumber,directive:s,directedPrompt:n,userId:e}),"prompt"===s?this.startServerTimer(10*r.BK,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.giveAnswer(e,{givenAnswer:this.liveAnswer})):(this.pointsPerPart.push("accept"===s?this.getPartValue():0),this.revealNextAnswer(),this.revealNextPart())}async next(e,{type:t}){if(this.queryingQuestion)return!1;if(this.bonusProgress===r.s.READING&&!this.settings.skip)return!1;clearInterval(this.timer.interval),this.emitMessage({type:"timer-update",timeRemaining:0});const s=this.bonusProgress===r.s.LAST_PART_REVEALED,n=this.pointsPerPart,a=this.players[e].teamId;"next"===t&&this.teams[a].updateStats(this.pointsPerPart.reduce((e,t)=>e+t,0));const o=this.teams[a].bonusStats,i=this.bonus;if(this.bonus=await this.advanceQuestion(),this.queryingQuestion=!1,!this.bonus)return this.emitMessage({type:"end",lastPartRevealed:s,oldBonus:i,pointsPerPart:n,stats:o,userId:e}),!1;this.emitMessage({type:t,bonus:this.bonus,lastPartRevealed:s,oldBonus:i,packetLength:this.packetLength,pointsPerPart:n,stats:o,teamId:a}),this.currentPartNumber=-1,this.pointsPerPart=[],this.bonusProgress=r.s.READING,this.revealLeadin(),this.revealNextPart()}revealLeadin(){this.emitMessage({type:"reveal-leadin",leadin:this.bonus.leadin})}revealNextAnswer(){const e=this.currentPartNumber===this.bonus.parts.length-1;e&&(this.bonusProgress=r.s.LAST_PART_REVEALED),this.emitMessage({type:"reveal-next-answer",answer:this.bonus.answers[this.currentPartNumber],currentPartNumber:this.currentPartNumber,lastPartRevealed:e})}revealNextPart(){this.bonusProgress!==r.s.LAST_PART_REVEALED&&(this.currentPartNumber++,this.emitMessage({type:"reveal-next-part",currentPartNumber:this.currentPartNumber,part:this.bonus.parts[this.currentPartNumber],value:this.getPartValue()}))}startAnswer(e){this.emitMessage({type:"start-answer",userId:e}),this.startServerTimer(10*r.BK,e=>this.emitMessage({type:"timer-update",timeRemaining:e}),()=>this.giveAnswer(e,{givenAnswer:this.liveAnswer}))}toggleCorrect(e,{partNumber:t,correct:s}){return"number"==typeof t&&!(t<0||t>=this.bonus.parts.length)&&void(this.pointsPerPart[t]=s?this.getPartValue(t):0)}toggleThreePartBonuses(e,{threePartBonuses:t}){this.query.threePartBonuses=t,this.adjustQuery(["threePartBonuses"],[t]),this.emitMessage({type:"toggle-three-part-bonuses",threePartBonuses:t})}}const p=(b={default:()=>e.default},w={},n.d(w,b),w);var b,w;function f(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!(""===t||null==t||!1===t||Array.isArray(t)&&0===t.length||"maxYear"===e&&t===r.d2||"questionType"===e&&"all"===t||"searchType"===e&&"all"===t)))}class E{static checkAnswer(e,t,s=7){return(0,p.default)(e,t,s)}static async getBonusById(e){return await fetch("/api/bonus-by-id?"+new URLSearchParams({id:e})).then(e=>e.json()).then(e=>e.bonus)}static async getNumPackets(e){return void 0===e||""===e?0:await fetch("/api/num-packets?"+new URLSearchParams({setName:e})).then(e=>e.json()).then(e=>e.numPackets)}static async getPacketBonuses(e,t){return""===e?[]:await fetch("/api/packet-bonuses?"+new URLSearchParams({setName:e,packetNumber:t})).then(e=>e.json()).then(e=>e.bonuses)}static async getPacketTossups(e,t){return""===e?[]:await fetch("/api/packet-tossups?"+new URLSearchParams({setName:e,packetNumber:t})).then(e=>e.json()).then(e=>e.tossups)}static async getRandomBonus({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,subcategories:o,threePartBonuses:i}){const c=f({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,subcategories:o,threePartBonuses:i});return await fetch("/api/random-bonus?"+new URLSearchParams(c)).then(e=>e.json()).then(e=>e.bonuses)}static async getRandomTossup({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,powermarkOnly:o,standardOnly:i,subcategories:c}){const l=f({alternateSubcategories:e,categories:t,difficulties:s,maxYear:n,minYear:r,number:a,powermarkOnly:o,standardOnly:i,subcategories:c});return await fetch("/api/random-tossup?"+new URLSearchParams(l)).then(e=>e.json()).then(e=>e.tossups)}static async getTossupById(e){return await fetch("/api/tossup-by-id?"+new URLSearchParams({id:e})).then(e=>e.json()).then(e=>e.tossup)}}let S=null;async function v(){if(null===S){if(S=await fetch("/auth/stars/bonus-ids").then(e=>e.ok?e.json():null),null===S)return null;S.sort(()=>Math.random()-.5)}if(0===S.length)return null;const e=S.pop();return await E.getBonusById(e)}class N extends y{constructor(e,t=[],s=[],n=[]){super(e,t,s,n),this.checkAnswer=E.checkAnswer,this.getRandomQuestions=async e=>await E.getRandomBonus({...e}),this.getSet=async({setName:e,packetNumbers:t})=>e?await E.getPacketBonuses(e,t[0]??1):[],this.getRandomStarredQuestion=v,this.getNumPackets=E.getNumPackets,this.settings={...this.settings,skip:!0,showHistory:!0,typeToAnswer:!0}}async message(e,t){switch(t.type){case"toggle-show-history":return this.toggleShowHistory(e,t);case"toggle-type-to-answer":return this.toggleTypeToAnswer(e,t);default:super.message(e,t)}}get liveAnswer(){return document.getElementById("answer-input").value}set liveAnswer(e){document.getElementById("answer-input").value=e}startAnswer(e){this.settings.typeToAnswer?super.startAnswer(e):this.giveAnswer(e,{givenAnswer:this.bonus.answers_sanitized[this.currentPartNumber]})}toggleShowHistory(e,{showHistory:t}){this.settings.showHistory=t,this.emitMessage({type:"toggle-show-history",showHistory:t,userId:e})}toggleTypeToAnswer(e,{typeToAnswer:t}){this.settings.typeToAnswer=t,this.emitMessage({type:"toggle-type-to-answer",typeToAnswer:t,teamId:e})}}},496:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(685);class r{static async recordBonus({_id:e,pointsPerPart:t}){await n.A.getUsername()&&fetch("/auth/question-stats/record-bonus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,pointsPerPart:t})}).then(e=>{if(401===e.status)throw n.A.deleteUsername(),new Error("Unauthenticated")})}static async recordTossup({_id:e,celerity:t,isCorrect:s,multiplayer:r,pointValue:a}){await n.A.getUsername()&&fetch("/auth/question-stats/record-tossup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,isCorrect:s,pointValue:a,celerity:t,multiplayer:r})}).then(e=>{if(401===e.status)throw n.A.deleteUsername(),new Error("Unauthenticated")})}}},563:(e,t,s)=>{s.d(t,{A:()=>n});class n{constructor(e){this.teamId=e,this.bonusStats={0:0,10:0,20:0,30:0}}clearStats(){this.bonusStats={0:0,10:0,20:0,30:0}}safelySetTeamName(e){return e||(e=""),this.teamName=e,this.teamName}updateStats(e){this.bonusStats[e]++}}},599:(e,t,s)=>{s.d(t,{A:()=>n});class n{static soundEffects="true"===window.localStorage.getItem("sound-effects");static buzz=new Audio("/audio/buzz.mp3");static correct=new Audio("/audio/correct.mp3");static incorrect=new Audio("/audio/incorrect.mp3");static power=new Audio("/audio/power.mp3")}},659:(e,t,s)=>{s.a(e,async(e,t)=>{try{var n=s(994),r=s(828),a=s(267),o=s(955),i=s(287),c=s(563),l=s(283),u=s(439),d=s(257),m=e([d]);d=(m.then?(await m)():m)[0];const g="2025-01-14",h="2025-05-07",y="2024-11-02",p="user",b="team",w=new u.A;w.players[p]=new i.A(p),w.players[p].teamId=b,w.teams[b]=new c.A(b);const f=new d.A(w,p),E={send:e=>f.onmessage(e),sendToServer:e=>w.message(p,e)};if(w.sockets[b]=E,document.getElementById("answer-form").addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation();const t=document.getElementById("answer-input").value;E.sendToServer({type:"give-answer",givenAnswer:t})}),document.getElementById("clear-stats").addEventListener("click",function(){this.blur(),w.sendToServer({type:"clear-stats"})}),document.getElementById("next").addEventListener("click",function(){this.blur(),"Skip"===this.innerHTML?E.sendToServer({type:"skip"}):E.sendToServer({type:"next"})}),document.getElementById("local-packet-input").addEventListener("change",function(){const e=this.files[0];if(e){const t=new window.FileReader;t.onload=function(t){try{const s=JSON.parse(t.target.result);E.sendToServer({type:"upload-local-packet",packet:s,filename:e.name})}catch(e){window.alert("Invalid packet format")}},t.readAsText(e)}}),document.getElementById("packet-number").addEventListener("change",function(){const e=(0,n.A)(this.value.trim(),w.setLength);return e.some(e=>1>e||e>w.setLength)?void document.getElementById("packet-number").classList.add("is-invalid"):(document.getElementById("packet-number").classList.remove("is-invalid"),void E.sendToServer({type:"set-packet-numbers",packetNumbers:e}))}),document.getElementById("report-question-submit").addEventListener("click",function(){(0,l.A)(document.getElementById("report-question-id").value,document.getElementById("report-question-reason").value,document.getElementById("report-question-description").value)}),document.getElementById("reveal").addEventListener("click",function(){this.blur(),E.sendToServer({type:"start-answer"})}),document.getElementById("set-mode").addEventListener("change",function(){this.blur(),E.sendToServer({type:"set-mode",mode:this.value})}),document.getElementById("set-name").addEventListener("change",function(){E.sendToServer({type:"set-set-name",setName:this.value.trim()})}),document.getElementById("set-strictness").addEventListener("change",function(){this.blur(),E.sendToServer({type:"set-strictness",strictness:this.value})}),document.getElementById("set-strictness").addEventListener("input",function(){document.getElementById("strictness-display").textContent=this.value}),document.getElementById("start").addEventListener("click",async function(){this.blur(),E.sendToServer({type:"start"})}),document.getElementById("toggle-randomize-order").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-randomize-order",randomizeOrder:this.checked})}),document.getElementById("toggle-settings").addEventListener("click",function(){this.blur(),document.getElementById("buttons").classList.toggle("col-lg-9"),document.getElementById("buttons").classList.toggle("col-lg-12"),document.getElementById("content").classList.toggle("col-lg-9"),document.getElementById("content").classList.toggle("col-lg-12"),document.getElementById("settings").classList.toggle("d-none"),document.getElementById("settings").classList.toggle("d-lg-none")}),document.getElementById("toggle-show-history").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-show-history",showHistory:this.checked})}),document.getElementById("toggle-standard-only").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-standard-only",standardOnly:this.checked})}),document.getElementById("toggle-three-part-bonuses").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-three-part-bonuses",threePartBonuses:this.checked})}),document.getElementById("toggle-timer").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-timer",timer:this.checked})}),document.getElementById("type-to-answer").addEventListener("click",function(){this.blur(),E.sendToServer({type:"toggle-type-to-answer",typeToAnswer:this.checked})}),document.getElementById("year-range-a").onchange=function(){const e=$("#slider").slider("values",0),t=$("#slider").slider("values",1);E.sendToServer({type:"set-year-range",minYear:e,maxYear:t})},document.getElementById("year-range-b").onchange=function(){const e=$("#slider").slider("values",0),t=$("#slider").slider("values",1);E.sendToServer({type:"set-year-range",minYear:e,maxYear:t})},document.addEventListener("keydown",e=>{if(!["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName))switch(e.key?.toLowerCase()){case" ":document.getElementById("reveal").click(),e.target===document.body&&e.preventDefault();break;case"e":return document.getElementById("toggle-settings").click();case"k":return document.getElementsByClassName("card-header-clickable")[0].click();case"n":return document.getElementById("next").click();case"s":return document.getElementById("start").click();case"t":return document.getElementsByClassName("star-bonus")[0].click();case"y":return navigator.clipboard.writeText(w.bonus._id??"");case"0":return document.getElementById(`checkbox-${w.pointsPerPart.length}`)?.click();case"1":return document.getElementById("checkbox-1").click();case"2":return document.getElementById("checkbox-2").click();case"3":return document.getElementById("checkbox-3").click();case"4":return document.getElementById("checkbox-4").click()}}),window.localStorage.getItem("singleplayer-bonus-mode"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-bonus-mode"));if(e.version!==g)throw new Error;E.sendToServer({type:"set-mode",...e})}catch{window.localStorage.removeItem("singleplayer-bonus-mode")}let S=[];if(window.localStorage.getItem("singleplayer-bonus-query"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-bonus-query"));if(e.version!==h)throw new Error;w.categoryManager.import(e),w.query=e,E.sendToServer({type:"set-packet-numbers",...e,doNotFetch:!0}),E.sendToServer({type:"set-set-name",...e,doNotFetch:!0}),E.sendToServer({type:"toggle-standard-only",...e,doNotFetch:!0}),E.sendToServer({type:"toggle-three-part-bonuses",...e}),S=e.difficulties}catch{window.localStorage.removeItem("singleplayer-bonus-query")}if($(document).ready(function(){try{const e=JSON.parse(window.localStorage.getItem("singleplayer-bonus-query"));E.sendToServer({type:"set-year-range",...e})}catch{}}),window.localStorage.getItem("singleplayer-bonus-settings"))try{const e=JSON.parse(window.localStorage.getItem("singleplayer-bonus-settings"));if(e.version!==y)throw new Error;E.sendToServer({type:"set-strictness",...e}),E.sendToServer({type:"toggle-show-history",...e}),E.sendToServer({type:"toggle-timer",...e}),E.sendToServer({type:"toggle-type-to-answer",...e})}catch{window.localStorage.removeItem("singleplayer-bonus-settings")}ReactDOM.createRoot(document.getElementById("category-modal-root")).render(React.createElement(a.A,{categoryManager:w.categoryManager,onClose:()=>E.sendToServer({type:"set-categories",...w.categoryManager.export()})})),ReactDOM.createRoot(document.getElementById("difficulty-dropdown-root")).render(React.createElement(o.A,{startingDifficulties:S??[],onChange:()=>E.sendToServer({type:"set-difficulties",difficulties:(0,r.cl)("difficulties")})})),t()}catch(e){t(e)}})},685:(e,t,s)=>{s.d(t,{A:()=>n});class n{static deleteUsername(){window.sessionStorage.setItem("account-username",JSON.stringify({username:null,expires:null})),document.getElementById("login-link").textContent="Log in",document.getElementById("login-link").href="/user/login"}static async getUsername(){let e;try{e=window.sessionStorage.getItem("account-username"),e=e?JSON.parse(e):{},e=e||{}}catch(t){e={},window.sessionStorage.setItem("account-username",JSON.stringify(e))}let{username:t,expires:s}=e;if(null===t)return null;if(void 0===t){const e=await fetch("/auth/get-username").then(e=>401===e.status?{username:null,expires:null}:e.json());t=e.username,window.sessionStorage.setItem("account-username",JSON.stringify(e))}else(null===s||s<Date.now())&&(t=null,window.sessionStorage.setItem("account-username",JSON.stringify({username:null,expires:null})));return t}static setUsername(e,t){window.sessionStorage.setItem("account-username",JSON.stringify({username:e,expires:t}))}}},828:(e,t,s)=>{function n(e){const t=[];return Array.from(document.getElementById(e).children).forEach(e=>{const s=e.querySelector("input");s.checked&&t.push(parseInt(s.value))}),t}s.d(t,{cl:()=>n})},837:(e,t,s)=>{s.d(t,{BK:()=>o,d2:()=>a,jG:()=>r,mT:()=>i,s:()=>c,zN:()=>n});const n=2e3,r=2010,a=2025,o=10,i=Object.freeze({SET_NAME:"select by set name",RANDOM:"random questions",STARRED:"starred questions",LOCAL:"local packet"}),c=Object.freeze({NOT_STARTED:0,READING:1,LAST_PART_REVEALED:2});Object.freeze({NOT_STARTED:0,READING:1,ANSWER_REVEALED:2})},901:(e,t,s)=>{s.a(e,async(e,n)=>{try{s.d(t,{A:()=>c});var r=s(837),a=s(251),o=s(118),i=e([o]);o=(i.then?(await i)():i)[0];class c extends o.A{onmessage(e){return JSON.parse(e).type,super.onmessage(e)}giveAnswer({currentPartNumber:e,directive:t,directedPrompt:s,userId:n}){super.giveAnswer({directive:t,directedPrompt:s,userId:n}),"accept"===t&&(document.getElementById(`checkbox-${e+1}`).checked=!0),"prompt"!==t&&(document.getElementById("reveal").disabled=!1)}next({bonus:e,oldBonus:t,packetLength:s,starred:n,type:r}){super.next({nextQuestion:e,packetLength:s,type:r}),"start"!==r&&(0,a.A)({bonus:t,starred:n}),"end"===r?(document.getElementById("next").disabled=!0,document.getElementById("reveal").disabled=!0):(document.getElementById("next").textContent="Skip",document.getElementById("reveal").disabled=!1)}setMode({mode:e}){switch(super.setMode({mode:e}),e){case r.mT.SET_NAME:document.getElementById("toggle-standard-only").disabled=!0,document.getElementById("toggle-three-part-bonuses").disabled=!0;break;case r.mT.RANDOM:document.getElementById("toggle-standard-only").disabled=!1,document.getElementById("toggle-three-part-bonuses").disabled=!1}}}n()}catch(e){n(e)}})},955:(e,t,s)=>{s.d(t,{A:()=>a});const n=[[0,"Pop Culture"],[1,"Middle School"],[2,"Easy High School"],[3,"Regular High School"],[4,"Hard High School"],[5,"National High School"],[6,"● / Easy College"],[7,"●● / Medium College"],[8,"●●● / Regionals College"],[9,"●●●● / Nationals College"],[10,"Open"]];function r({startChecked:e=!1,label:t,value:s}){const[n,r]=React.useState(e);return React.createElement("li",{className:n?"active":void 0},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:s,onClick:function(e){r(e.target.checked)},defaultChecked:n}),s,": ",t))}const a=function({startingDifficulties:e=[],onChange:t=()=>{}}){return React.createElement("div",{className:"dropdown-checklist btn-group w-100"},React.createElement("button",{className:"btn btn-default text-start w-100",id:"dropdownMenu1","data-bs-toggle":"dropdown",type:"button","aria-expanded":"true","aria-haspopup":"true"},"Difficulties"),React.createElement("button",{className:"btn btn-default dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown",type:"button"}),React.createElement("ul",{className:"dropdown-menu checkbox-menu allow-focus",id:"difficulties","aria-labelledby":"dropdownMenu1",onClick:e=>e.stopPropagation(),onChange:t},n.map(([t,s])=>React.createElement(r,{key:t,label:s,startChecked:e.includes(t),value:t}))))}},994:(e,t,s)=>{function n(e){if(0===e.length)return"";let t="",s=(e=(e=[...new Set(e)]).sort((e,t)=>e-t))[0],n=e[0];for(let r=1;r<e.length;r++)e[r]-n===1||(t=s===n?`${t}, ${s}`:`${t}, ${s}-${n}`,s=e[r]),n=e[r];return t=s===n?`${t}, ${s}`:`${t}, ${s}-${n}`,t.slice(2)}function r(e,t=0){0===e.length&&(e=`1-${t}`),e.endsWith("-")&&(e+=t);const s=e.split(","),n=[];for(let e=0;e<s.length;e++){const t=s[e].trim().split("-");1===t.length?n.push([parseInt(t[0]),parseInt(t[0])]):n.push([parseInt(t[0]),parseInt(t[1])])}const r=[];for(let e=0;e<n.length;e++)for(let t=n[e][0];t<=n[e][1];t++)r.push(t);return r}s.d(t,{A:()=>r,w:()=>n})}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return o[e](s,s.exports,c),s.exports}t="function"==typeof Symbol,s=t?Symbol("webpack queues"):"__webpack_queues__",n=t?Symbol("webpack exports"):"__webpack_exports__",r=t?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},c.a=(e,t,o)=>{var i;o&&((i=[]).d=-1);var c,l,u,d=new Set,m=e.exports,g=new Promise((e,t)=>{u=t,l=e});g[n]=m,g[s]=e=>(i&&e(i),d.forEach(e),g.catch(e=>{})),e.exports=g,t(e=>{var t;c=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[s])return e;if(e.then){var t=[];t.d=0,e.then(e=>{o[n]=e,a(t)},e=>{o[r]=e,a(t)});var o={};return o[s]=e=>e(t),o}}var i={};return i[s]=e=>{},i[n]=e,i}))(e);var o=()=>c.map(e=>{if(e[r])throw e[r];return e[n]}),l=new Promise(e=>{(t=()=>e(o)).r=0;var n=e=>e!==i&&!d.has(e)&&(d.add(e),e&&!e.d&&(t.r++,e.push(t)));c.map(e=>e[s](n))});return t.r?l:o()},e=>(e?u(g[r]=e):l(m),a(i))),i&&i.d<0&&(i.d=0)},c.d=(e,t)=>{for(var s in t)c.o(t,s)&&!c.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c(659);